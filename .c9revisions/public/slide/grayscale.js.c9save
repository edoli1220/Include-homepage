{"revisions":{"1337289178986":{"ts":1337289178986,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"function initGrayscale() {\r\n\t\t// Fade in images so there isn't a color \"pop\" document load and then on window load\r\n\t\t$(\"div#slide-gallery img\").fadeIn(500);\r\n\t\t\r\n\t\t// clone image\r\n\t\tvar i = 0;\r\n\t\t$('div#slide-gallery img').each(function(){\r\n\t\t\tvar el = $(this);\r\n\t\t\tel.css({\"position\":\"absolute\"})\r\n\t\t\t.wrap(\"<div class='image_wrapper' id=wrapper_\" + $(this).attr('id') + \" style='position:absolute;float: left;'>\")\r\n\t\t\t.clone().addClass('img_grayscale').css({\"position\":\"absolute\",\"z-index\":i*30+30,\"opacity\":\"0\"}).insertBefore(el).queue(function(){\r\n\t\t\t\tvar el = $(this);\r\n\t\t\t\tel.parent().css({\"width\":this.width,\"height\":this.height});\r\n\t\t\t\tel.dequeue();\r\n\t\t\t});\r\n\t\t\tthis.src = grayscale(this.src);\r\n\t\t\t$(this).css(\"z-index\",i*30+15);\r\n\t\t\ti++;\r\n\t\t});\r\n\t\t\r\n\t\t// Fade image \r\n\t\t$('div#slide-gallery img').mouseover(function(){\r\n\t\t\t$(this).animate({opacity:1}, 500);\r\n\t\t})\r\n\t\t$('div#slide-gallery .img_grayscale').mouseout(function(){\r\n\t\t\t$(this).stop().animate({opacity:0}, 500);\r\n\t\t});\t\t\r\n}\r\n\t\r\n\t// Grayscale w canvas method\r\n\tfunction grayscale(src){\r\n\t\tvar canvas = document.createElement('canvas');\r\n\t\tvar ctx = canvas.getContext('2d');\r\n\t\tvar imgObj = new Image();\r\n\t\timgObj.src = src;\r\n\t\tcanvas.width = imgObj.width;\r\n\t\tcanvas.height = imgObj.height; \r\n\t\tctx.drawImage(imgObj, 0, 0); \r\n\t\tvar imgPixels = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n\t\tfor(var y = 0; y < imgPixels.height; y++){\r\n\t\t\tfor(var x = 0; x < imgPixels.width; x++){\r\n\t\t\t\tvar i = (y * 4) * imgPixels.width + x * 4;\r\n\t\t\t\tvar avg = (imgPixels.data[i] + imgPixels.data[i + 1] + imgPixels.data[i + 2]) / 3;\r\n\t\t\t\timgPixels.data[i] = avg; \r\n\t\t\t\timgPixels.data[i + 1] = avg; \r\n\t\t\t\timgPixels.data[i + 2] = avg;\r\n\t\t\t}\r\n\t\t}\r\n\t\tctx.putImageData(imgPixels, 0, 0, 0, 0, imgPixels.width, imgPixels.height);\r\n\t\treturn canvas.toDataURL();\r\n    }"]],"start1":0,"start2":0,"length1":0,"length2":1819}]],"length":1819}}}