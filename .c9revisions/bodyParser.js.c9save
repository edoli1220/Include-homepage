{"revisions":{"1337515313196":{"ts":1337515313196,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var qs = require('qs');\n\nfunction mime(req) {\n  var str = req.headers['content-type'] || '';\n  return str.split(';')[0];\n}\n\nfunction error(code){\n  var err = new Error(http.STATUS_CODES[code]);\n  err.status = code;\n  return err;\n};\n\nvar multipart = module.exports = function(options){\n  options = options || {};\n  return function multipart(req, res, next) {\n    if (req._body) return next();\n    req.body = req.body || {};\n    req.files = req.files || {};\n\n    // ignore GET\n    if ('GET' == req.method || 'HEAD' == req.method) return next();\n\n    // check Content-Type\n    if ('multipart/form-data' != mime(req)) return next();\n\n    // flag as parsed\n    req._body = true;\n\n    // parse\n    var form = new formidable.IncomingForm\n      , data = {}\n      , files = {}\n      , done;\n\n    Object.keys(options).forEach(function(key){\n      form[key] = options[key];\n    });\n\n    function ondata(name, val, data){\n      if (Array.isArray(data[name])) {\n        data[name].push(val);\n      } else if (data[name]) {\n        data[name] = [data[name], val];\n      } else {\n        data[name] = val;\n      }\n    }\n\n    form.on('field', function(name, val){\n      ondata(name, val, data);\n    });\n\n    form.on('progress', function(bytesReceived, bytesExpected){\n\n    });\n\n    form.on('file', function(name, val){\n      ondata(name, val, files);\n    });\n\n    form.on('error', function(err){\n      next(err);\n      done = true;\n    });\n\n    form.on('end', function(){\n      if (done) return;\n      try {\n        req.body = qs.parse(data);\n        req.files = qs.parse(files);\n        next();\n      } catch (err) {\n        next(err);\n      }\n    });\n\n    form.parse(req);\n  }\n};\n\n\nvar json = module.exports = function(options){\n  options = options || {};\n  return function json(req, res, next) {\n    if (req._body) return next();\n    req.body = req.body || {};\n\n    // ignore GET\n    if ('GET' == req.method || 'HEAD' == req.method) return next();\n\n    // check Content-Type\n    if ('application/json' != mime(req)) return next();\n\n    // flag as parsed\n    req._body = true;\n\n    // parse\n    var buf = '';\n    req.setEncoding('utf8');\n    req.on('data', function(chunk){ buf += chunk });\n    req.on('end', function(){\n      if ('{' != buf[0] && '[' != buf[0]) return next(error(400));\n      try {\n        req.body = JSON.parse(buf);\n        next();\n      } catch (err){\n        err.status = 400;\n        next(err);\n      }\n    });\n  }\n};\n\nvar urlencoded = module.exports = function(options){\n  options = options || {};\n  return function urlencoded(req, res, next) {\n    if (req._body) return next();\n    req.body = req.body || {};\n\n    // ignore GET\n    if ('GET' == req.method || 'HEAD' == req.method) return next();\n\n    // check Content-Type\n    if ('application/x-www-form-urlencoded' != mime(req)) return next();\n\n    // flag as parsed\n    req._body = true;\n\n    // parse\n    var buf = '';\n    req.setEncoding('utf8');\n    req.on('data', function(chunk){ buf += chunk });\n    req.on('end', function(){\n      try {\n        req.body = buf.length\n          ? qs.parse(buf, options)\n          : {};\n        next();\n      } catch (err){\n        next(err);\n      }\n    });\n  }\n};\n\nexports = module.exports = function bodyParser(options){\n  var _urlencoded = urlencoded(options)\n    , _multipart = multipart(options)\n    , _json = json(options);\n\n  return function bodyParser(req, res, next) {\n    _json(req, res, function(err){\n      if (err) return next(err);\n      _urlencoded(req, res, function(err){\n        if (err) return next(err);\n        _multipart(req, res, next);\n      });\n    });\n  }\n};"]],"start1":0,"start2":0,"length1":0,"length2":3587}]],"length":3587},"1337525611581":{"contributors":[],"silentsave":false,"ts":1337525611581,"patch":[[{"diffs":[[0,"re('qs')"],[1,"\nio              = require('socket.io')"],[0,";\n\nfunct"]],"start1":14,"start2":14,"length1":16,"length2":55}]],"length":3626,"saved":false},"1337525619761":{"contributors":[],"silentsave":false,"ts":1337525619761,"patch":[[{"diffs":[[0,"s')\n"],[-1,"io             "],[1,"  , io"],[0," = r"]],"start1":19,"start2":19,"length1":23,"length2":14}]],"length":3617,"saved":false},"1337525639335":{"contributors":[],"silentsave":false,"ts":1337525639335,"patch":[[{"diffs":[[0,"\n    }\n\n"],[1,"    io.sockets.on('connection', function (socket) {\n      socket.emit('news', { hello: 'world' });\n      socket.on('my other event', function (data) {\n        console.log(data);\n      });\n    });\n\n"],[0,"    form"]],"start1":1128,"start2":1128,"length1":16,"length2":213}]],"length":3814,"saved":false},"1337525646941":{"contributors":[],"silentsave":false,"ts":1337525646941,"patch":[[{"diffs":[[0,") {\n"],[-1,"      socket.emit('news', { hello: 'world' });\n"],[0,"    "]],"start1":1184,"start2":1184,"length1":55,"length2":8}]],"length":3767,"saved":false},"1337527780457":{"contributors":[],"silentsave":false,"ts":1337527780457,"patch":[[{"diffs":[[0," (socket) {\n"],[1,"      console.log('socket on');\n"],[0,"      socket"]],"start1":1176,"start2":1176,"length1":24,"length2":56},{"diffs":[[0,") {\n"],[-1,"        console.log(data);\n"],[0,"    "]],"start1":1268,"start2":1268,"length1":35,"length2":8}]],"length":3772,"saved":false},"1337527888029":{"contributors":[],"silentsave":false,"ts":1337527888029,"patch":[[{"diffs":[[0,"');\n"],[-1,"      socket.on('my other event', function (data) {\n      });\n"],[0,"    "]],"start1":1216,"start2":1216,"length1":70,"length2":8}]],"length":3710,"saved":false},"1337527976833":{"contributors":[],"silentsave":false,"ts":1337527976833,"patch":[[{"diffs":[[0,"ected){\n"],[1,"      io.sockets.emit('user disconnected');"],[0,"\n    });"]],"start1":1367,"start2":1367,"length1":16,"length2":59}]],"length":3753,"saved":false},"1337528016812":{"contributors":[],"silentsave":false,"ts":1337528016812,"patch":[[{"diffs":[[0,"it('"],[-1,"user disconnected'"],[1,"dataProgress' {\n        progressPercent: bytesReceived bytesExpected\n      }"],[0,");\n "]],"start1":1394,"start2":1394,"length1":26,"length2":84}]],"length":3811,"saved":false},"1337528102301":{"contributors":[],"silentsave":false,"ts":1337528102301,"patch":[[{"diffs":[[0,"Received"],[1," / (bytesReceived +"],[0," bytesEx"]],"start1":1444,"start2":1444,"length1":16,"length2":35},{"diffs":[[0,"Expected"],[1,") * 100"],[0,"\n      }"]],"start1":1477,"start2":1477,"length1":16,"length2":23}]],"length":3837,"saved":false},"1337528121764":{"contributors":[],"silentsave":false,"ts":1337528121764,"patch":[[{"diffs":[[0,"rogress'"],[1,"."],[0," {\n     "]],"start1":1403,"start2":1403,"length1":16,"length2":17}]],"length":3838,"saved":false},"1337528123752":{"contributors":[],"silentsave":false,"ts":1337528123752,"patch":[[{"diffs":[[0,"rogress'"],[-1,"."],[1,","],[0," {\n     "]],"start1":1403,"start2":1403,"length1":17,"length2":17}]],"length":3838,"saved":false},"1337528261423":{"contributors":[],"silentsave":false,"ts":1337528261423,"patch":[[{"diffs":[[0," }\n\n"],[-1,"    io.sockets.on('connection', function (socket) {\n      console.log('socket on');\n    });\n"],[0,"\n   "]],"start1":1132,"start2":1132,"length1":100,"length2":8}]],"length":3746,"saved":false},"1337529296215":{"contributors":[],"silentsave":false,"ts":1337529296215,"patch":[[{"diffs":[[0,"s')\n  , "],[-1,"io"],[1,"socket;\n\nsocket         "],[0," = requi"]],"start1":19,"start2":19,"length1":18,"length2":40},{"diffs":[[0,"re('"],[1,"./"],[0,"socket"],[-1,".io"],[0,"');\n"]],"start1":59,"start2":59,"length1":17,"length2":16}]],"length":3767,"saved":false},"1337529300078":{"contributors":[],"silentsave":false,"ts":1337529300078,"patch":[[{"diffs":[[0,"\nsocket "],[-1,"         "],[0,"= requir"]],"start1":35,"start2":35,"length1":25,"length2":16}]],"length":3758,"saved":false},"1337529312462":{"contributors":[],"silentsave":false,"ts":1337529312462,"patch":[[{"diffs":[[0,"    "],[-1,"io."],[0,"socket"],[-1,"s"],[0,".emi"]],"start1":1297,"start2":1297,"length1":18,"length2":14}]],"length":3754,"saved":false},"1337529317255":{"contributors":[],"silentsave":false,"ts":1337529317255,"patch":[[{"diffs":[[0," socket."],[1,"socket()."],[0,"emit('da"]],"start1":1300,"start2":1300,"length1":16,"length2":25}]],"length":3763,"saved":false},"1337529388629":{"contributors":[],"silentsave":false,"ts":1337529388629,"patch":[[{"diffs":[[0,"var qs "],[1,"\n  , socket;\n  \n  \nqs     "],[0,"= requir"]],"start1":0,"start2":0,"length1":15,"length2":41},{"diffs":[[0,"re('qs')"],[-1,"\n  , socket;\n"],[1,";"],[0,"\nsocket "]],"start1":40,"start2":40,"length1":29,"length2":17}]],"length":3777,"saved":false},"1337529393476":{"contributors":[],"silentsave":false,"ts":1337529393476,"patch":[[{"diffs":[[0,", socket"],[1,"\n  , currentFile"],[0,";\n  \n  \n"]],"start1":10,"start2":10,"length1":16,"length2":32}]],"length":3793,"saved":false},"1337529440496":{"contributors":[],"silentsave":false,"ts":1337529440496,"patch":[[{"diffs":[[0,"files);\n    });\n"],[1,"    form.on('fileBegin', function(name, file) {\n      \n    });"],[0,"\n    form.on('er"]],"start1":1533,"start2":1533,"length1":32,"length2":94}]],"length":3855,"saved":false},"1337529455312":{"contributors":[],"silentsave":false,"ts":1337529455312,"patch":[[{"diffs":[[0," function(name, "],[-1,"val"],[1,"file"],[0,"){\n      ondata("]],"start1":1487,"start2":1487,"length1":35,"length2":36},{"diffs":[[0,"a(name, "],[-1,"val"],[1,"file"],[0,", files)"]],"start1":1521,"start2":1521,"length1":19,"length2":20}]],"length":3857,"saved":false},"1337529461970":{"contributors":[],"silentsave":false,"ts":1337529461970,"patch":[[{"diffs":[[0,"{\n      "],[1,"currentFile = file;"],[0,"\n    });"]],"start1":1597,"start2":1597,"length1":16,"length2":35}]],"length":3876,"saved":false},"1337529483168":{"contributors":[],"silentsave":false,"ts":1337529483168,"patch":[[{"diffs":[[0,"= file;\n"],[1,"      console.log(currentFile.name);\n"],[0,"    });\n"]],"start1":1617,"start2":1617,"length1":16,"length2":53}]],"length":3913,"saved":false},"1337529487954":{"contributors":[],"silentsave":false,"ts":1337529487954,"patch":[[{"diffs":[[0,".name);\n"],[1,"      console.log(name);\n"],[0,"    });\n"]],"start1":1654,"start2":1654,"length1":16,"length2":41}]],"length":3938,"saved":false},"1337540401739":{"contributors":[],"silentsave":false,"ts":1337540401739,"patch":[[{"diffs":[[0,"le;\n"],[-1,"      console.log(currentFile.name);\n      console.log(name);\n"],[0,"    "]],"start1":1621,"start2":1621,"length1":70,"length2":8}]],"length":3876,"saved":false},"1337540435073":{"contributors":[],"silentsave":false,"ts":1337540435073,"patch":[[{"diffs":[[0,"ess', {\n"],[1,"        index          : index;\n"],[0,"        "]],"start1":1362,"start2":1362,"length1":16,"length2":48}]],"length":3908,"saved":false},"1337540445502":{"contributors":[],"silentsave":false,"ts":1337540445502,"patch":[[{"diffs":[[0,"        "],[1,"  "],[0,"index   "]],"start1":1370,"start2":1370,"length1":16,"length2":18},{"diffs":[[0," : index"],[-1,";"],[0,"\n       "],[1," ,"],[0," progres"]],"start1":1394,"start2":1394,"length1":25,"length2":26}]],"length":3911,"saved":false},"1337540454600":{"contributors":[],"silentsave":false,"ts":1337540454600,"patch":[[{"diffs":[[0,"\n    }\n\n"],[1,"    var index;\n    "],[0,"\n    for"]],"start1":1170,"start2":1170,"length1":16,"length2":35}]],"length":3930,"saved":false},"1337540459495":{"contributors":[],"silentsave":false,"ts":1337540459495,"patch":[[{"diffs":[[0,"ar index"],[1," = 0"],[0,";\n    \n "]],"start1":1183,"start2":1183,"length1":16,"length2":20}]],"length":3934,"saved":false},"1337540474711":{"contributors":[],"silentsave":false,"ts":1337540474711,"patch":[[{"diffs":[[0,"index = "],[-1,"0"],[1,"-1"],[0,";\n    \n "]],"start1":1186,"start2":1186,"length1":17,"length2":18}]],"length":3935,"saved":false},"1337540515951":{"contributors":[],"silentsave":false,"ts":1337540515951,"patch":[[{"diffs":[[0,"= file;\n"],[1,"      index ++;\n"],[0,"    });\n"]],"start1":1676,"start2":1676,"length1":16,"length2":32}]],"length":3951,"saved":false},"1337542460075":{"contributors":[],"silentsave":false,"ts":1337542460075,"patch":[[{"diffs":[[0,"ected){\n"],[1,"      console.log(bytesReceived + bytesExpected);\n"],[0,"      so"]],"start1":1341,"start2":1341,"length1":16,"length2":66}]],"length":4001,"saved":false},"1337542465294":{"contributors":[],"silentsave":false,"ts":1337542465294,"patch":[[{"diffs":[[0,"(bytesReceived +"],[1," ':::::::' +"],[0," bytesExpected);"]],"start1":1366,"start2":1366,"length1":32,"length2":44}]],"length":4013,"saved":false},"1337542493289":{"contributors":[],"silentsave":false,"ts":1337542493289,"patch":[[{"diffs":[[0,"d){\n"],[-1,"      console.log(bytesReceived + ':::::::' + bytesExpected);\n"],[0,"    "]],"start1":1345,"start2":1345,"length1":70,"length2":8}]],"length":3951,"saved":false},"1337542497807":{"contributors":[],"silentsave":false,"ts":1337542497807,"patch":[[{"diffs":[[0,"ed /"],[-1," (bytesReceived +"],[0," byt"]],"start1":1465,"start2":1465,"length1":25,"length2":8},{"diffs":[[0,"Expected"],[-1,")"],[0," * 100\n "]],"start1":1475,"start2":1475,"length1":17,"length2":16}]],"length":3933,"saved":false},"1337542568043":{"contributors":[],"silentsave":false,"ts":1337542568043,"patch":[[{"diffs":[[0,"le, files);\n"],[1,"      socket.socket().emit('dataProgress', {\n          index          : index\n        , progressPercent: bytesReceived / bytesExpected * 100\n      });\n"],[0,"    });\n    "]],"start1":1572,"start2":1572,"length1":24,"length2":175}]],"length":4084,"saved":false},"1337542572104":{"contributors":[],"silentsave":false,"ts":1337542572104,"patch":[[{"diffs":[[0,"ent:"],[-1," bytesReceived / bytesExpected *"],[0," 100"]],"start1":1684,"start2":1684,"length1":40,"length2":8}]],"length":4052,"saved":false},"1337542692984":{"contributors":[],"silentsave":false,"ts":1337542692984,"patch":[[{"diffs":[[0,"le, files);\n"],[1,"      console.log(name);\n"],[0,"      socket"]],"start1":1572,"start2":1572,"length1":24,"length2":49}]],"length":4077,"saved":false},"1337542697963":{"contributors":[],"silentsave":false,"ts":1337542697963,"patch":[[{"diffs":[[0,"dex ++;\n"],[1,"      console.log(name);\n"],[0,"    });\n"]],"start1":1818,"start2":1818,"length1":16,"length2":41}]],"length":4102,"saved":false},"1337542789504":{"contributors":[],"silentsave":false,"ts":1337542789504,"patch":[[{"diffs":[[0,"dex = -1"],[1,"\n      , bytes"],[0,";\n    \n "]],"start1":1188,"start2":1188,"length1":16,"length2":30}]],"length":4116,"saved":false},"1337542791699":{"contributors":[],"silentsave":false,"ts":1337542791699,"patch":[[{"diffs":[[0," , bytes"],[1," = {}"],[0,";\n    \n "]],"start1":1202,"start2":1202,"length1":16,"length2":21}]],"length":4121,"saved":false},"1337542817746":{"contributors":[],"silentsave":false,"ts":1337542817746,"patch":[[{"diffs":[[0,"bytes = "],[-1,"{}"],[1,"[]"],[0,";\n    \n "]],"start1":1205,"start2":1205,"length1":18,"length2":18}]],"length":4121,"saved":false},"1337542827579":{"contributors":[],"silentsave":false,"ts":1337542827579,"patch":[[{"diffs":[[0,"e);\n"],[-1,"      socket.socket().emit('dataProgress', {\n          index          : index\n        , progressPercent: 100\n      });\n"],[0,"    "]],"start1":1624,"start2":1624,"length1":127,"length2":8},{"diffs":[[0,"++;\n"],[-1,"      console.log(name);\n"],[0,"    "]],"start1":1722,"start2":1722,"length1":33,"length2":8}]],"length":3977,"saved":false},"1337542842761":{"contributors":[],"silentsave":false,"ts":1337542842761,"patch":[[{"diffs":[[0,"= file;\n"],[1,"      bytes[index] = file.size;\n"],[0,"      in"]],"start1":1702,"start2":1702,"length1":16,"length2":48}]],"length":4009,"saved":false},"1337542863222":{"contributors":[],"silentsave":false,"ts":1337542863222,"patch":[[{"diffs":[[0,"tes = []"],[1,"\n      , prevBytes"],[0,";\n    \n "]],"start1":1207,"start2":1207,"length1":16,"length2":34}]],"length":4027,"saved":false},"1337542864824":{"contributors":[],"silentsave":false,"ts":1337542864824,"patch":[[{"diffs":[[0,"revBytes"],[1," = 0"],[0,";\n    \n "]],"start1":1225,"start2":1225,"length1":16,"length2":20}]],"length":4031,"saved":false},"1337542939706":{"contributors":[],"silentsave":false,"ts":1337542939706,"patch":[[{"diffs":[[0,"ytes = 0"],[1,"\n      , bytesTotal"],[0,";\n    \n "]],"start1":1229,"start2":1229,"length1":16,"length2":35}]],"length":4050,"saved":false},"1337542940651":{"contributors":[],"silentsave":false,"ts":1337542940651,"patch":[[{"diffs":[[0,"tesTotal"],[1," = 0"],[0,";\n    \n "]],"start1":1248,"start2":1248,"length1":16,"length2":20}]],"length":4054,"saved":false},"1337542960212":{"contributors":[],"silentsave":false,"ts":1337542960212,"patch":[[{"diffs":[[0,"* 100\n      });\n"],[1,"      bytesTotal = bytesReceived;\n"],[0,"    });\n\n    for"]],"start1":1548,"start2":1548,"length1":32,"length2":66}]],"length":4088,"saved":false},"1337542971257":{"contributors":[],"silentsave":false,"ts":1337542971257,"patch":[[{"diffs":[[0,"me, file) {\n"],[1,"      prevBytes = bytesTotal;\n"],[0,"      curren"]],"start1":1751,"start2":1751,"length1":24,"length2":54}]],"length":4118,"saved":false},"1337542985457":{"contributors":[],"silentsave":false,"ts":1337542985457,"patch":[[{"diffs":[[0,"ercent: "],[1,"("],[0,"bytesRec"]],"start1":1510,"start2":1510,"length1":16,"length2":17},{"diffs":[[0,"Received"],[1," - prevBytes)"],[0," / bytes"]],"start1":1524,"start2":1524,"length1":16,"length2":29}]],"length":4132,"saved":false},"1337542994274":{"contributors":[],"silentsave":false,"ts":1337542994274,"patch":[[{"diffs":[[0," / bytes"],[-1,"Expected"],[1,"[index]"],[0," * 100\n "]],"start1":1545,"start2":1545,"length1":24,"length2":23}]],"length":4131,"saved":false},"1337543060401":{"contributors":[],"silentsave":false,"ts":1337543060401,"patch":[[{"diffs":[[0,"= file;\n"],[1,"      console.log(file);\n"],[0,"      by"]],"start1":1824,"start2":1824,"length1":16,"length2":41}]],"length":4156,"saved":false},"1337543185848":{"contributors":[],"silentsave":false,"ts":1337543185848,"patch":[[{"diffs":[[0,"= -1"],[-1,"\n      , bytes = []\n      , prevBytes = 0\n      , bytesTotal = 0"],[0,""],[1,""],[0,";\n  "]],"start1":1192,"start2":1192,"length1":72,"length2":8},{"diffs":[[0,"ercent: "],[-1,"("],[0,"bytesRec"]],"start1":1446,"start2":1446,"length1":17,"length2":16},{"diffs":[[0,"ved "],[-1,"- prevBytes) / bytes[index] * 100\n      });\n      bytesTotal = bytesReceived"],[1,"/ bytesExpected * 100\n      })"],[0,";\n  "]],"start1":1464,"start2":1464,"length1":84,"length2":38},{"diffs":[[0,"    "],[-1,"});\n    form.on('fileBegin', function(name, file) {\n      prevBytes = bytesTotal;\n      currentFile = file;\n      console.log(file);\n      bytes[index] = file.siz"],[1,"  socket.socket().emit('dataProgress', {\n          index          : index\n        , progressPercent: 100\n      });\n    });\n    form.on('fileBegin', function(name, file) {\n      currentFile = fil"],[0,"e;\n "]],"start1":1609,"start2":1609,"length1":170,"length2":202}]],"length":4077,"saved":false},"1337543205370":{"contributors":[],"silentsave":false,"ts":1337543205370,"patch":[[{"diffs":[[0," }\n\n"],[-1,"    var index = -1;\n"],[0,"    "]],"start1":1174,"start2":1174,"length1":28,"length2":8},{"diffs":[[0,", {\n"],[-1,"          index          : index\n"],[0,"    "]],"start1":1370,"start2":1370,"length1":41,"length2":8},{"diffs":[[0,"le;\n"],[-1,"      index ++;\n"],[0,"    "]],"start1":1753,"start2":1753,"length1":24,"length2":8}]],"length":4008,"saved":false},"1337547905836":{"contributors":[],"silentsave":false,"ts":1337547905836,"patch":[[{"diffs":[[0,"s);\n"],[-1,"      console.log(name);\n      socket.socket().emit('dataProgress', {\n          index          : index\n        , progressPercent: 100\n      });\n"],[0,"    "]],"start1":1527,"start2":1527,"length1":152,"length2":8}]],"length":3864,"saved":false},"1337548022977":{"contributors":[],"silentsave":false,"ts":1337548022977,"patch":[[{"diffs":[[0,"\n       "],[-1," ,"],[0," progres"]],"start1":1373,"start2":1373,"length1":18,"length2":16}]],"length":3862,"saved":false}}}