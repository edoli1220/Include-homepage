{"revisions":{"1337239488031":{"ts":1337239488031,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var model\r\n  , documentModel\r\n  , availableBoards\r\n  , fs\r\n  , boardName;\r\n\r\nmodel           = require('./models');\r\ndocumentModel   = model.DocumentModel;\r\navailableBoards = model.AvailableBoard;\r\nfs              = require('fs');\r\n\r\n\r\n// 로그인 확인 함수\r\nfunction isAuthenticated(req) {\r\n  var isAuthenticated;\r\n  if (req.session.user) {\r\n    isAuthenticated = true;\r\n  } else {\r\n    isAuthenticated = false;\r\n  }\r\n  return isAuthenticated;\r\n}\r\n\r\n// 문서가 있는지 확인 .. req가 들어오면 작성자의 글인지 확인\r\nfunction isValidDocument(err, document, req) {\r\n  if (err || !document) {\r\n    return false;\r\n  }\r\n  if (req) {\r\n    if (document.name != (req.session.user && req.session.user.nickname)) {\r\n      return false; \r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n// 사용 가능 보드 확인\r\nfunction isAvailableBoard(boardName, req, callback) {\r\n  var isAvailable = true;\r\n  \r\n  availableBoards().findOne({'boardName': boardName}, function(err, board) {\r\n    if (!board) {\r\n      isAvailable = false;\r\n    } else {\r\n      // 로그인 사용 가능 보드 확인\r\n      if (board.auth && !isAuthenticated(req)) {\r\n        isAvailable = false;\r\n      }\r\n    }\r\n    \r\n    callback(isAvailable);\r\n  });\r\n}\r\n\r\n// Board List\r\nexports.listBoard = function (req, res) {\r\n  var upper\r\n    , lower\r\n    , index\r\n    , numbers\r\n    , model\r\n    , maxIndex;\r\n\r\n  if (req.query.index) {\r\n    index = req.query.index;\r\n  } else {\r\n    index = 1;\r\n  }\r\n\r\n  boardName = req.params.board;\r\n  model = documentModel(boardName);\r\n\r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    \r\n    model.count(function(err, count) {\r\n    upper = count - index * 15 + 15;\r\n    lower = count - index * 15 + 1;\r\n\r\n    numbers = [];\r\n    maxIndex = (count / 15);\r\n    for (i = 0; i < maxIndex; i++) {\r\n      numbers[i] = i + 1;\r\n    }\r\n\r\n    model.find({'id' : {'$gte': lower, '$lte': upper}})\r\n      .sort('id', -1)\r\n      .run(function(err, documents) {\r\n        res.render('board/listBoard', {\r\n            documents      : documents\r\n          , boardName      : boardName\r\n          , numbers        : numbers\r\n          , isAuthenticated: isAuthenticated(req)\r\n        });\r\n        return;\r\n      });\r\n    });\r\n  });\r\n\r\n  \r\n};\r\n\r\n// Read Document\r\nexports.readBoard = function(req, res) {\r\n  var id\r\n    , content;\r\n  id        = req.params.id;\r\n  boardName = req.params.board;\r\n\r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    \r\n    documentModel(boardName).findById(id, function(err, document) {\r\n      if (!isValidDocument(err, document)) {\r\n        res.redirect('/board/'+boardName);\r\n        return;\r\n      }\r\n  \r\n      res.render('board/readBoard', {\r\n          document       : document\r\n        , boardName      : boardName\r\n        , isAuthenticated: isAuthenticated(req)\r\n        , user           : req.session.user\r\n        , isWriter       : (document.writer == (req.session.user && req.session.user.nickname))\r\n      });\r\n      return;\r\n    });\r\n  });  \r\n};\r\n\r\n// Post new Document\r\nexports.postBoard = function(req, res) {\r\n  boardName = req.params.board;\r\n  \r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    \r\n    documentModel(boardName).find()\r\n    .sort('id', -1)\r\n    .limit(1)\r\n    .run(function (err, documents) {\r\n      var document\r\n        , dataFile\r\n        , file\r\n        , buffer\r\n        , name\r\n        , index;\r\n\r\n      document = documents[0];\r\n      if (document) {\r\n        index = document.id + 1;\r\n      } else {\r\n        index = 0;\r\n      }\r\n\r\n      if (req.body.title == '') {\r\n        req.body.title = '제목없음';\r\n      }\r\n      documentData          = new (documentModel(boardName))();\r\n      documentData.id       = index;\r\n      documentData.title    = req.body.title;\r\n      documentData.writer   = req.session.user.nickname;\r\n      documentData.content  = req.body.content;\r\n      documentData.date     = Date.now();\r\n      documentData.comments = [];\r\n\r\n      var i = 0;\r\n      while (dataFile = req.files['dataFile' + i]) {\r\n        if (dataFile.size > 0) {\r\n          file = fs.readFileSync(dataFile.path)\r\n          buffer = new Buffer(file);\r\n          documentData.files[i] = {name: dataFile.name, data: buffer.toString('base64')};\r\n        }\r\n        i ++;\r\n      }\r\n\r\n      documentData.save( function(err) {\r\n        res.redirect('/board/' + boardName);\r\n        return;\r\n      });\r\n    });\r\n  });\r\n  \r\n};\r\n\r\n// Update Document\r\nexports.updateBoard = function(req, res) {\r\n  var id\r\n    , dataFile\r\n    , file\r\n    , buffer\r\n    , conditions\r\n    , updates\r\n    , model\r\n    , fileLength;\r\n\r\n  boardName = req.params.board;\r\n  id        = req.params.id;\r\n  model     = documentModel(boardName);\r\n\r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    model.findById(id, function(err, document) {\r\n      if (!isValidDocument(err, document, req)) {\r\n        res.redirect('/board/'+boardName);\r\n        return;\r\n      }\r\n  \r\n      if (req.body.title == '') {\r\n        req.body.title = '제목없음';\r\n      }\r\n      conditions = {'_id': id};\r\n  \r\n      updates = {};\r\n      updates.title   = req.body.title;\r\n      updates.content = req.body.content;\r\n      updates.date    = Date.now();\r\n  \r\n      var i = 0;\r\n      updates.files = [];\r\n      //원본 파일 집어넣기\r\n      updates.files = document.files;\r\n      fileLength = updates.files.length;\r\n  \r\n      while (dataFile = req.files['dataFile' + i]) {\r\n        if (dataFile.size > 0) {\r\n          file = fs.readFileSync(dataFile.path)\r\n          buffer = new Buffer(file);\r\n          updates.files[i + fileLength] = {name: dataFile.name, data: buffer.toString('base64')};\r\n        }\r\n        i ++;\r\n      }\r\n  \r\n      model.update(conditions, updates, function(err) {\r\n        res.redirect('/board/' + boardName);\r\n        return;\r\n      });\r\n    });\r\n  });\r\n\r\n\r\n};\r\n\r\n// Delete Document\r\nexports.deleteBoard = function(req, res) {\r\n  var id;\r\n\r\n  boardName = req.params.board;\r\n  id        = req.params.id;\r\n  \r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    documentModel(boardName).findById(id, function(err, document) {\r\n      if (!isValidDocument(err, document, req)) {\r\n        res.redirect('/board/'+boardName);\r\n        return;\r\n      }\r\n  \r\n      document.remove();\r\n      res.redirect('/board/' + boardName);\r\n      return;\r\n    });\r\n  });\r\n  \r\n\r\n};\r\n\r\n// Write New Document\r\nexports.newBoard = function(req, res) {\r\n  boardName = req.params.board;\r\n  \r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    if (!isAuthenticated(req)) {\r\n      res.redirect('/board/'+boardName);\r\n      return;\r\n    }\r\n    res.render('board/editBoard', { document: new documentModel(), boardName: boardName, isAuthenticated: isAuthenticated(req)});\r\n    return;\r\n  });\r\n  \r\n};\r\n\r\n// Edit Current Document\r\nexports.editBoard = function(req, res) {\r\n  var id\r\n    , content;\r\n  id = req.params.id;\r\n  boardName = req.params.board;\r\n  \r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    if (!isAuthenticated(req)) {\r\n      res.redirect('/board/'+boardName);\r\n      return;\r\n    }\r\n  \r\n    documentModel(boardName).findById(id, function(err, document) {\r\n  \r\n      if (!isValidDocument(err, document, req)) {\r\n        res.redirect('/board/'+boardName);\r\n        return;\r\n      }\r\n  \r\n      res.render('board/editBoard', {\r\n          document       : document\r\n        , boardName      : boardName\r\n        , isAuthenticated: isAuthenticated(req)\r\n      });\r\n      return;\r\n    });\r\n  });\r\n  \r\n};\r\n\r\n// Add New Comment\r\nexports.commentBoard = function(req, res) {\r\n  var id\r\n    , conditions\r\n    , updates\r\n    , date;\r\n\r\n  id        = req.params.id;\r\n  boardName = req.params.board;\r\n  \r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    if (!isAuthenticated(req)) {\r\n      res.redirect('/board/' + boardName + '/read/' + id);\r\n      return;\r\n    }\r\n  \r\n  \r\n    documentModel(boardName).findById(id, function(err, document) {\r\n  \r\n      if (!isValidDocument(err, document)) {\r\n        res.redirect('/board/' + boardName + '/read/' + id);\r\n        return;\r\n      }\r\n  \r\n      conditions = {'_id': id}\r\n  \r\n      updates = {};\r\n      updates.comments = document.comments;\r\n      updates.comments.push({\r\n          name   : req.session.user.nickname\r\n        , content: req.body.content\r\n        , date   : Date.now()\r\n      });\r\n  \r\n      documentModel(boardName).update(conditions, updates, function(err) {\r\n        res.redirect('/board/' + boardName + '/read/' + id);\r\n        return;\r\n      });\r\n    });\r\n  });\r\n\r\n};\r\n\r\n// Delete Current Comment\r\nexports.deleteCommentBoard = function (req, res) {\r\n  var idDocument\r\n    , idComment\r\n    , updates\r\n    , conditions\r\n    , comments\r\n    , newComments\r\n    , length;\r\n  \r\n  idDocument = req.params.id;\r\n  idComment  = req.params.idComment;\r\n  boardName  = req.params.board;\r\n  \r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    if (!isAuthenticated(req)) {\r\n      res.redirect('/board/' + boardName + '/read/' + id);\r\n      return;\r\n    }\r\n    \r\n    documentModel(boardName).findById(idDocument, function(err, document) {\r\n  \r\n      if (!isValidDocument(err, document)) {\r\n        res.redirect('/board/' + boardName + '/read/' + id);\r\n        return;\r\n      }\r\n      \r\n      comments = document.comments;\r\n      length = comments.length;\r\n      newComments = [];\r\n      \r\n      for (var i = 0; i < length; i++) {\r\n        if (comments[i]._id == idComment) {\r\n          if (comments[i].name != req.session.user.nickname) {\r\n            newComments.push(comments[i]);\r\n          } \r\n        } else {\r\n          newComments.push(comments[i]);\r\n        }\r\n      }\r\n      \r\n      updates = { comments: newComments };\r\n      \r\n      conditions = {'_id': idDocument};\r\n      \r\n      documentModel(boardName).update(conditions, updates, function(err) {\r\n        res.redirect('/board/' + boardName + '/read/' + idDocument);\r\n        return;\r\n      });\r\n    });\r\n  });\r\n};\r\n\r\n// Get Document File\r\nexports.getBoardFile = function(req, res) {\r\n  var id\r\n    , name\r\n    , file\r\n    , buffer;\r\n  id        = req.query.id\r\n  name      = req.query.name;\r\n  boardName = req.query.boardName;\r\n\r\n  isAvailableBoard(boardName, req, function(isAvailable) {\r\n    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    documentModel(boardName).findById(id, function(err, document) {\r\n      if (!isValidDocument(err, document)) {\r\n        res.redirect('/board/'+boardName);\r\n        return;\r\n      }\r\n  \r\n      var dataLength;\r\n      \r\n      dataLength = document.files.length;\r\n      for (i = 0; i < dataLength; i++) {\r\n        if (document.files[i].name == name) {\r\n  \r\n          buffer = new Buffer(document.files[i].data, 'base64');\r\n  \r\n          res.writeHead(200, {'Content-Disposition':'attachment; filename=' + name});\r\n          res.write(buffer, 'binary');\r\n          res.end();\r\n          return;\r\n        }\r\n      }\r\n    });\r\n  });\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":11467}]],"length":11467},"1337283266590":{"contributors":[],"silentsave":false,"ts":1337283266590,"patch":[[{"diffs":[[0,"ocument."],[-1,"name"],[1,"writer"],[0," != (req"]],"start1":604,"start2":604,"length1":20,"length2":22},{"diffs":[[0,"vailable"],[1,", message"],[0,");\r\n  })"]],"start1":1114,"start2":1114,"length1":16,"length2":25},{"diffs":[[0,"r, document) {\r\n"],[-1,"  \r\n"],[0,"      if (!isVal"]],"start1":7544,"start2":7544,"length1":36,"length2":32},{"diffs":[[0,"rn;\r\n      }\r\n  "],[1,"  "],[0,"\r\n      res.rend"]],"start1":7667,"start2":7667,"length1":32,"length2":34}]],"length":11476,"saved":false},"1337283296530":{"contributors":[],"silentsave":false,"ts":1337283296530,"patch":[[{"diffs":[[0,"me, req,"],[1," res,"],[0," callbac"]],"start1":778,"start2":778,"length1":16,"length2":21}]],"length":11481,"saved":false},"1337283302185":{"contributors":[],"silentsave":false,"ts":1337283302185,"patch":[[{"diffs":[[0,"able"],[-1,", message"],[0,");\r\n"]],"start1":1123,"start2":1123,"length1":17,"length2":8}]],"length":11472,"saved":false},"1337283339841":{"contributors":[],"silentsave":false,"ts":1337283339841,"patch":[[{"diffs":[[0," {\r\n"],[-1,"    if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n"],[0,"    "]],"start1":2435,"start2":2435,"length1":82,"length2":8},{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n"],[0,"    "]],"start1":3150,"start2":3150,"length1":78,"length2":8}]],"length":11328,"saved":false},"1337283353226":{"contributors":[],"silentsave":false,"ts":1337283353226,"patch":[[{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }"],[0,"\r\n  "]],"start1":4744,"start2":4744,"length1":76,"length2":8},{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }"],[0,"\r\n  "]],"start1":6010,"start2":6010,"length1":76,"length2":8}]],"length":11192,"saved":false},"1337283357884":{"contributors":[],"silentsave":false,"ts":1337283357884,"patch":[[{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }"],[0,"\r\n  "]],"start1":6484,"start2":6484,"length1":76,"length2":8}]],"length":11124,"saved":false},"1337283364908":{"contributors":[],"silentsave":false,"ts":1337283364908,"patch":[[{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }"],[0,"\r\n  "]],"start1":6963,"start2":6963,"length1":76,"length2":8},{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }"],[0,"\r\n  "]],"start1":7732,"start2":7732,"length1":76,"length2":8}]],"length":10988,"saved":false},"1337283368976":{"contributors":[],"silentsave":false,"ts":1337283368976,"patch":[[{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }"],[0,"\r\n  "]],"start1":8893,"start2":8893,"length1":76,"length2":8}]],"length":10920,"saved":false},"1337283374383":{"contributors":[],"silentsave":false,"ts":1337283374383,"patch":[[{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }"],[0,"\r\n  "]],"start1":10214,"start2":10214,"length1":76,"length2":8}]],"length":10852,"saved":false},"1337283378744":{"contributors":[],"silentsave":false,"ts":1337283378744,"patch":[[{"diffs":[[0,"    "],[-1,"if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n"],[0,"    "]],"start1":1510,"start2":1510,"length1":78,"length2":8}]],"length":10782,"saved":false},"1337283406353":{"contributors":[],"silentsave":false,"ts":1337283406353,"patch":[[{"diffs":[[0,"   }\r\n    \r\n"],[1,"    if (!isAvailable) {\r\n      if (!isAvailable) {\r\n      res.redirect('/');\r\n      return; \r\n    }\r\n    \r\n"],[0,"    callback"]],"start1":1091,"start2":1091,"length1":24,"length2":131},{"diffs":[[0,"ble) {\r\n    "],[-1,"    "],[0,"\r\n    model."]],"start1":1609,"start2":1609,"length1":28,"length2":24}]],"length":10885,"saved":false},"1337283411257":{"contributors":[],"silentsave":false,"ts":1337283411257,"patch":[[{"diffs":[[0," {\r\n"],[-1,"      if (!isAvailable) {\r\n"],[0,"    "]],"start1":1124,"start2":1124,"length1":35,"length2":8}]],"length":10858,"saved":false},"1337283460896":{"contributors":[],"silentsave":false,"ts":1337283460896,"patch":[[{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":1548,"start2":1548,"length1":32,"length2":37},{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":3119,"start2":3119,"length1":32,"length2":37},{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":4718,"start2":4718,"length1":32,"length2":37}]],"length":10873,"saved":false},"1337283478111":{"contributors":[],"silentsave":false,"ts":1337283478111,"patch":[[{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":5989,"start2":5989,"length1":32,"length2":37},{"diffs":[[0,"isAvailable) {\r\n"],[-1,""],[0,"    \r\n    docume"]],"start1":6020,"start2":6020,"length1":32,"length2":32},{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":6468,"start2":6468,"length1":32,"length2":37},{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":6952,"start2":6952,"length1":32,"length2":37},{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":7726,"start2":7726,"length1":32,"length2":37},{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":8892,"start2":8892,"length1":32,"length2":37},{"diffs":[[0,"ardName;\r\n\r\n"],[-1,""],[0,"  isAvailabl"]],"start1":10188,"start2":10188,"length1":24,"length2":24},{"diffs":[[0,"(boardName, req,"],[1," res,"],[0," function(isAvai"]],"start1":10218,"start2":10218,"length1":32,"length2":37}]],"length":10903,"saved":false},"1337283488533":{"contributors":[],"silentsave":false,"ts":1337283488533,"patch":[[{"diffs":[[0,"me, req,"],[1," res,"],[0," functio"]],"start1":2416,"start2":2416,"length1":16,"length2":21}]],"length":10908,"saved":false},"1337283519950":{"contributors":[],"silentsave":false,"ts":1337283519950,"patch":[[{"diffs":[[0,"ailable) {\r\n"],[1,"      if (boardName) {\r\n        \r\n      } else {\r\n  "],[0,"      res.re"]],"start1":1116,"start2":1116,"length1":24,"length2":76},{"diffs":[[0,"rect('/');\r\n"],[1,"      }\r\n"],[0,"      return"]],"start1":1194,"start2":1194,"length1":24,"length2":33}]],"length":10969,"saved":false},"1337283541217":{"contributors":[],"silentsave":false,"ts":1337283541217,"patch":[[{"diffs":[[0," {\r\n        "],[1,"res.redirect('/?board='+boardName);"],[0,"\r\n      } el"]],"start1":1148,"start2":1148,"length1":24,"length2":59}]],"length":11004,"saved":false},"1337283543149":{"contributors":[],"silentsave":false,"ts":1337283543149,"patch":[[{"diffs":[[0,"?board='"],[-1,"+"],[1," + "],[0,"boardNam"]],"start1":1175,"start2":1175,"length1":17,"length2":19}]],"length":11006,"saved":false},"1337283856791":{"contributors":[],"silentsave":false,"ts":1337283856791,"patch":[[{"diffs":[[0,"lable = true"],[1,"\r\n    ,type"],[0,";\r\n  \r\n  ava"]],"start1":817,"start2":817,"length1":24,"length2":35}]],"length":11017,"saved":false},"1337283865414":{"contributors":[],"silentsave":false,"ts":1337283865414,"patch":[[{"diffs":[[0,"(!board) {\r\n"],[1,"      type = 0;\r\n"],[0,"      isAvai"]],"start1":932,"start2":932,"length1":24,"length2":41}]],"length":11034,"saved":false},"1337283870536":{"contributors":[],"silentsave":false,"ts":1337283870536,"patch":[[{"diffs":[[0,"icated(req)) {\r\n"],[1,"        type = 1;\r\n"],[0,"        isAvaila"]],"start1":1063,"start2":1063,"length1":32,"length2":51}]],"length":11053,"saved":false},"1337283933000":{"contributors":[],"silentsave":false,"ts":1337283933000,"patch":[[{"diffs":[[0,"rd=' + boardName"],[1," + '?type=' + type"],[0,");\r\n      } else"]],"start1":1226,"start2":1226,"length1":32,"length2":50}]],"length":11071,"saved":false},"1337284051040":{"contributors":[],"silentsave":false,"ts":1337284051040,"patch":[[{"diffs":[[0,"Name + '"],[-1,"?"],[1,"&"],[0,"type=' +"]],"start1":1238,"start2":1238,"length1":17,"length2":17}]],"length":11071,"saved":false},"1337284245915":{"contributors":[],"silentsave":false,"ts":1337284245915,"patch":[[{"diffs":[[0,"   ,type"],[1,"\r\n    ,resJson"],[0,";\r\n  \r\n "]],"start1":832,"start2":832,"length1":16,"length2":30}]],"length":11085,"saved":false},"1337284262769":{"contributors":[],"silentsave":false,"ts":1337284262769,"patch":[[{"diffs":[[0,"e);\r\n      }"],[-1," else {\r\n  "],[1,"\r\n"],[0,"      res.re"]],"start1":1273,"start2":1273,"length1":35,"length2":26},{"diffs":[[0,"ect("],[-1,"'/');\r\n      }"],[1,"resJson);"],[0,"\r\n  "]],"start1":1302,"start2":1302,"length1":22,"length2":17}]],"length":11071,"saved":false},"1337284279690":{"contributors":[],"silentsave":false,"ts":1337284279690,"patch":[[{"diffs":[[0,"n;\r\n  \r\n"],[1,"  resJson = {}\r\n"],[0,"  availa"]],"start1":853,"start2":853,"length1":16,"length2":32},{"diffs":[[0," res"],[-1,".redirect('/?board=' + boardName + '&type=' + type);"],[1,"Json"],[0,"\r\n  "]],"start1":1236,"start2":1236,"length1":60,"length2":12}]],"length":11039,"saved":false},"1337284281181":{"contributors":[],"silentsave":false,"ts":1337284281181,"patch":[[{"diffs":[[0,"son = {}"],[1,";"],[0,"\r\n  avai"]],"start1":867,"start2":867,"length1":16,"length2":17}]],"length":11040,"saved":false},"1337284289633":{"contributors":[],"silentsave":false,"ts":1337284289633,"patch":[[{"diffs":[[0," resJson"],[1,".boardName = boardName;"],[0,"\r\n      "]],"start1":1237,"start2":1237,"length1":16,"length2":39}]],"length":11063,"saved":false},"1337284297195":{"contributors":[],"silentsave":false,"ts":1337284297195,"patch":[[{"diffs":[[0,"d) {\r\n      "],[1,"resJson."],[0,"type = 0;\r\n "]],"start1":969,"start2":969,"length1":24,"length2":32},{"diffs":[[0,"        "],[1,"resJson."],[0,"type = 1"]],"start1":1118,"start2":1118,"length1":16,"length2":24}]],"length":11079,"saved":false},"1337284377177":{"contributors":[],"silentsave":false,"ts":1337284377177,"patch":[[{"diffs":[[0,"    res."],[-1,"redirect"],[1,"json"],[0,"(resJson"]],"start1":1297,"start2":1297,"length1":24,"length2":20}]],"length":11075,"saved":false},"1337284416241":{"contributors":[],"silentsave":false,"ts":1337284416241,"patch":[[{"diffs":[[0,"res."],[-1,"json"],[1,"sned"],[0,"(res"]],"start1":1301,"start2":1301,"length1":12,"length2":12}]],"length":11075,"saved":false},"1337284417942":{"contributors":[],"silentsave":false,"ts":1337284417942,"patch":[[{"diffs":[[0,"   res.s"],[-1,"n"],[0,"e"],[1,"n"],[0,"d(resJso"]],"start1":1298,"start2":1298,"length1":18,"length2":18}]],"length":11075,"saved":false},"1337284670205":{"contributors":[],"silentsave":false,"ts":1337284670205,"patch":[[{"diffs":[[0,"res."],[-1,"send(resJson"],[1,"redirect("],[0,");\r\n"]],"start1":1301,"start2":1301,"length1":20,"length2":17}]],"length":11072,"saved":false},"1337284720472":{"contributors":[],"silentsave":false,"ts":1337284720472,"patch":[[{"diffs":[[0,"edirect("],[1,"'/?board=' + resJson.boardName + '&type=' + resJson.type"],[0,");\r\n    "]],"start1":1306,"start2":1306,"length1":16,"length2":72}]],"length":11128,"saved":false},"1337367625811":{"contributors":[],"silentsave":false,"ts":1337367625811,"patch":[[{"diffs":[[0,"\r\n  "],[-1,"model = documentModel(boardName);"],[0,"\r\n\r\n"]],"start1":1709,"start2":1709,"length1":41,"length2":8},{"diffs":[[0,"lable) {\r\n    \r\n"],[1,"    model = documentModel(boardName);\r\n    \r\n"],[0,"    model.count("]],"start1":1772,"start2":1772,"length1":32,"length2":77}]],"length":11140,"saved":false},"1337367628794":{"contributors":[],"silentsave":false,"ts":1337367628794,"patch":[[{"diffs":[[0,"d;\r\n  \r\n"],[-1,"\r\n"],[0,"  isAvai"]],"start1":1707,"start2":1707,"length1":18,"length2":16}]],"length":11138,"saved":false},"1337367650868":{"contributors":[],"silentsave":false,"ts":1337367650868,"patch":[[{"diffs":[[0,"\r\n  "],[-1,"model     = documentModel(boardName);\r\n"],[0,"\r\n  "]],"start1":4890,"start2":4890,"length1":47,"length2":8},{"diffs":[[0,"lable) {\r\n    \r\n"],[1,"    model     = documentModel(boardName);\r\n    \r\n"],[0,"    model.findBy"]],"start1":4951,"start2":4951,"length1":32,"length2":81}]],"length":11148,"saved":false},"1337367653857":{"contributors":[],"silentsave":false,"ts":1337367653857,"patch":[[{"diffs":[[0,"  model "],[-1,"    "],[0,"= docume"]],"start1":4969,"start2":4969,"length1":20,"length2":16}]],"length":11144,"saved":false},"1337368709652":{"contributors":[],"silentsave":false,"ts":1337368709652,"patch":[[{"diffs":[[0,"\n      }\r\n    });\r\n  });\r\n};"],[1,"\r\n\r\nexports.checkBoard = function (req, res) {\r\n  \r\n}"]],"start1":11116,"start2":11116,"length1":28,"length2":81}]],"length":11197,"saved":false},"1337368712401":{"contributors":[],"silentsave":false,"ts":1337368712401,"patch":[[{"diffs":[[0,", res) {\r\n  "],[1," "],[0,"\r\n}"]],"start1":11182,"start2":11182,"length1":15,"length2":16}]],"length":11198,"saved":false},"1337368722263":{"contributors":[],"silentsave":false,"ts":1337368722263,"patch":[[{"diffs":[[0,", name\r\n"],[-1,"    , file\r\n"],[0,"    , bu"]],"start1":10309,"start2":10309,"length1":28,"length2":16}]],"length":11186,"saved":false},"1337368745267":{"contributors":[],"silentsave":false,"ts":1337368745267,"patch":[[{"diffs":[[0,"s) {\r\n  "],[-1," "],[1,"boardName = req.query.boardName;\r\n   isAvailableBoard(boardName, req, res, function(isAvailable) {"],[0,"\r\n}"]],"start1":11174,"start2":11174,"length1":12,"length2":109}]],"length":11283,"saved":false},"1337368751603":{"contributors":[],"silentsave":false,"ts":1337368751603,"patch":[[{"diffs":[[0,"ble) {\r\n"],[1,"     \r\n   });\r\n"],[0,"}"]],"start1":11274,"start2":11274,"length1":9,"length2":24}]],"length":11298,"saved":false},"1337368817669":{"contributors":[],"silentsave":false,"ts":1337368817669,"patch":[[{"diffs":[[0,"eq, res,"],[1," check,"],[0," callbac"]],"start1":783,"start2":783,"length1":16,"length2":23}]],"length":11305,"saved":false},"1337368848588":{"contributors":[],"silentsave":false,"ts":1337368848588,"patch":[[{"diffs":[[0,"ue\r\n"],[-1,"    ,type\r\n"],[0,"    "]],"start1":834,"start2":834,"length1":19,"length2":8}]],"length":11294,"saved":false},"1337368879705":{"contributors":[],"silentsave":false,"ts":1337368879705,"patch":[[{"diffs":[[0,"res,"],[-1," check,"],[0," cal"]],"start1":787,"start2":787,"length1":15,"length2":8}]],"length":11287,"saved":false},"1337368894929":{"contributors":[],"silentsave":false,"ts":1337368894929,"patch":[[{"diffs":[[0,"n;\r\n  \r\n"],[1,"  if (params.length == 4) {\r\n    \r\n  }\r\n  \r\n"],[0,"  resJso"]],"start1":842,"start2":842,"length1":16,"length2":60}]],"length":11331,"saved":false},"1337368899854":{"contributors":[],"silentsave":false,"ts":1337368899854,"patch":[[{"diffs":[[0,"ngth == "],[-1,"4"],[1,"3"],[0,") {\r\n   "]],"start1":865,"start2":865,"length1":17,"length2":17}]],"length":11331,"saved":false},"1337368924225":{"contributors":[],"silentsave":false,"ts":1337368924225,"patch":[[{"diffs":[[0,"= 3) {\r\n    "],[1,"callback = params[2];"],[0,"\r\n  }\r\n  \r\n "]],"start1":871,"start2":871,"length1":24,"length2":45}]],"length":11352,"saved":false},"1337368969364":{"contributors":[],"silentsave":false,"ts":1337368969364,"patch":[[{"diffs":[[0,"\r\n  if ("],[-1,"p"],[0,"ar"],[-1,"am"],[1,"gument"],[0,"s.length"]],"start1":848,"start2":848,"length1":21,"length2":24},{"diffs":[[0,"lback = "],[-1,"p"],[0,"ar"],[-1,"am"],[1,"gument"],[0,"s[2];\r\n "]],"start1":889,"start2":889,"length1":21,"length2":24}]],"length":11358,"saved":false},"1337368973152":{"contributors":[],"silentsave":false,"ts":1337368973152,"patch":[[{"diffs":[[0,"ts[2];\r\n"],[1,"    res = null;\r\n"],[0,"  }\r\n  \r"]],"start1":904,"start2":904,"length1":16,"length2":33}]],"length":11375,"saved":false},"1337368986039":{"contributors":[],"silentsave":false,"ts":1337368986039,"patch":[[{"diffs":[[0,"  \r\n    if ("],[1,"res && "],[0,"!isAvailable"]],"start1":1270,"start2":1270,"length1":24,"length2":31}]],"length":11382,"saved":false},"1337368997732":{"contributors":[],"silentsave":false,"ts":1337368997732,"patch":[[{"diffs":[[0,"(boardName, req,"],[-1," res,"],[0," function(isAvai"]],"start1":11319,"start2":11319,"length1":37,"length2":32}]],"length":11377,"saved":false},"1337369012473":{"contributors":[],"silentsave":false,"ts":1337369012473,"patch":[[{"diffs":[[0,"le) {\r\n     "],[1,"if (isAvailable) {\r\n       \r\n     }"],[0,"\r\n   });\r\n}"]],"start1":11354,"start2":11354,"length1":23,"length2":58}]],"length":11412,"saved":false},"1337369047226":{"contributors":[],"silentsave":false,"ts":1337369047226,"patch":[[{"diffs":[[0,"me;\r\n   "],[1," "],[0,"isAvaila"]],"start1":11295,"start2":11295,"length1":16,"length2":17},{"diffs":[[0,"le) {\r\n     "],[1," "],[0,"if (isAvaila"]],"start1":11355,"start2":11355,"length1":24,"length2":25},{"diffs":[[0,") {\r\n       "],[-1,"\r\n"],[1," res.json({}); \r\n      } else {\r\n       \r\n "],[0,"     }\r\n   }"]],"start1":11383,"start2":11383,"length1":26,"length2":67}]],"length":11455,"saved":false},"1337369052831":{"contributors":[],"silentsave":false,"ts":1337369052831,"patch":[[{"diffs":[[0,"e {\r\n       "],[1," res.json({});"],[0,"\r\n      }\r\n "]],"start1":11423,"start2":11423,"length1":24,"length2":38}]],"length":11469,"saved":false},"1337369081199":{"contributors":[],"silentsave":false,"ts":1337369081199,"patch":[[{"diffs":[[0,"allback("],[-1,"isAvailable"],[1,"resJson"],[0,");\r\n  })"]],"start1":1492,"start2":1492,"length1":27,"length2":23}]],"length":11465,"saved":false},"1337369099858":{"contributors":[],"silentsave":false,"ts":1337369099858,"patch":[[{"diffs":[[0,"var "],[-1,"isAvailable = true\r\n    ,"],[0,"resJ"]],"start1":807,"start2":807,"length1":33,"length2":8}]],"length":11440,"saved":false},"1337369113163":{"contributors":[],"silentsave":false,"ts":1337369113163,"patch":[[{"diffs":[[0,"= 0;\r\n      "],[1,"resJson."],[0,"isAvailable "]],"start1":1046,"start2":1046,"length1":24,"length2":32},{"diffs":[[0,"1;\r\n        "],[1,"resJson."],[0,"isAvailable "]],"start1":1201,"start2":1201,"length1":24,"length2":32}]],"length":11456,"saved":false},"1337369116500":{"contributors":[],"silentsave":false,"ts":1337369116500,"patch":[[{"diffs":[[0,"res && !"],[1,"resJson."],[0,"isAvaila"]],"start1":1273,"start2":1273,"length1":16,"length2":24}]],"length":11464,"saved":false},"1337369127819":{"contributors":[],"silentsave":false,"ts":1337369127819,"patch":[[{"diffs":[[0," = {};\r\n"],[1,"  resJson.isAvailable = true;\r\n"],[0,"  availa"]],"start1":922,"start2":922,"length1":16,"length2":47}]],"length":11495,"saved":false},"1337369153775":{"contributors":[],"silentsave":false,"ts":1337369153775,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":1862,"start2":1862,"length1":35,"length2":31}]],"length":11491,"saved":false},"1337369156780":{"contributors":[],"silentsave":false,"ts":1337369156780,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":2763,"start2":2763,"length1":35,"length2":31}]],"length":11487,"saved":false},"1337369159497":{"contributors":[],"silentsave":false,"ts":1337369159497,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n       "]],"start1":3475,"start2":3475,"length1":35,"length2":31}]],"length":11483,"saved":false},"1337369162919":{"contributors":[],"silentsave":false,"ts":1337369162919,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":5031,"start2":5031,"length1":35,"length2":31}]],"length":11479,"saved":false},"1337369165830":{"contributors":[],"silentsave":false,"ts":1337369165830,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":6343,"start2":6343,"length1":35,"length2":31}]],"length":11475,"saved":false},"1337369167899":{"contributors":[],"silentsave":false,"ts":1337369167899,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":6818,"start2":6818,"length1":35,"length2":31}]],"length":11471,"saved":false},"1337369171967":{"contributors":[],"silentsave":false,"ts":1337369171967,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":7298,"start2":7298,"length1":35,"length2":31}]],"length":11467,"saved":false},"1337369175552":{"contributors":[],"silentsave":false,"ts":1337369175552,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":8068,"start2":8068,"length1":35,"length2":31}]],"length":11463,"saved":false},"1337369181027":{"contributors":[],"silentsave":false,"ts":1337369181027,"patch":[[{"diffs":[[0,"s, function("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":9230,"start2":9230,"length1":35,"length2":31}]],"length":11459,"saved":false},"1337369185011":{"contributors":[],"silentsave":false,"ts":1337369185011,"patch":[[{"diffs":[[0,", function(i"],[-1,"sAvailable"],[1,"resJson"],[0,") {\r\n    \r\n "]],"start1":10541,"start2":10541,"length1":34,"length2":31}]],"length":11456,"saved":false},"1337369188068":{"contributors":[],"silentsave":false,"ts":1337369188068,"patch":[[{"diffs":[[0,"unction("],[-1,"i"],[0,"resJson)"]],"start1":10544,"start2":10544,"length1":17,"length2":16}]],"length":11455,"saved":false},"1337369191218":{"contributors":[],"silentsave":false,"ts":1337369191218,"patch":[[{"diffs":[[0,"unction("],[-1,"isAvailable"],[1,"resJson"],[0,") {\r\n   "]],"start1":11324,"start2":11324,"length1":27,"length2":23}]],"length":11451,"saved":false},"1337369198246":{"contributors":[],"silentsave":false,"ts":1337369198246,"patch":[[{"diffs":[[0,"es.json("],[-1,"{}"],[1,"resJson"],[0,"); \r\n   "]],"start1":11379,"start2":11379,"length1":18,"length2":23}]],"length":11456,"saved":false},"1337369203499":{"contributors":[],"silentsave":false,"ts":1337369203499,"patch":[[{"diffs":[[0,"    "],[-1,"if (isAvailable) {\r\n        res.json(resJson); \r\n      } else {\r\n        res.json({});\r\n      }"],[1,"  res.json(resJson); "],[0,"\r\n  "]],"start1":11346,"start2":11346,"length1":103,"length2":29}]],"length":11382,"saved":false},"1337369207375":{"contributors":[],"silentsave":false,"ts":1337369207375,"patch":[[{"diffs":[[0,"n) {\r\n      "],[-1,"  "],[0,"res.json(res"]],"start1":11338,"start2":11338,"length1":26,"length2":24}]],"length":11380,"saved":false},"1337369214910":{"contributors":[],"silentsave":false,"ts":1337369214910,"patch":[[{"diffs":[[0,"); \r\n   "],[1," "],[0,"});\r\n}"]],"start1":11366,"start2":11366,"length1":14,"length2":15}]],"length":11381,"saved":false},"1337369221322":{"contributors":[],"silentsave":false,"ts":1337369221322,"patch":[[{"diffs":[[0,"dName;\r\n"],[-1,"  "],[0,"  isAvai"]],"start1":11278,"start2":11278,"length1":18,"length2":16},{"diffs":[[0,"son) {\r\n    "],[-1,"  "],[0,"res.json(res"]],"start1":11334,"start2":11334,"length1":26,"length2":24},{"diffs":[[0,"son); \r\n"],[-1,"  "],[0,"  });\r\n}"]],"start1":11359,"start2":11359,"length1":18,"length2":16}]],"length":11375,"saved":false},"1337369327365":{"contributors":[],"silentsave":false,"ts":1337369327365,"patch":[[{"diffs":[[0," {\r\n"],[-1,"      if (boardName) {\r\n        resJson.boardName = boardName;\r\n      }\r\n"],[0,"    "]],"start1":1332,"start2":1332,"length1":81,"length2":8}]],"length":11302,"saved":false},"1337369332938":{"contributors":[],"silentsave":false,"ts":1337369332938,"patch":[[{"diffs":[[0," true;\r\n"],[1,"  if (boardName) {\r\n    resJson.boardName = boardName;\r\n  }\r\n"],[0,"  availa"]],"start1":953,"start2":953,"length1":16,"length2":77}]],"length":11363,"saved":false},"1337369699511":{"contributors":[],"silentsave":false,"ts":1337369699511,"patch":[[{"diffs":[[0,"boardName = req."],[-1,"query"],[1,"params"],[0,".boardName;\r\n  i"]],"start1":11240,"start2":11240,"length1":37,"length2":38}]],"length":11364,"saved":false},"1337370017915":{"contributors":[],"silentsave":false,"ts":1337370017915,"patch":[[{"diffs":[[0,"params.board"],[-1,"Name"],[0,";\r\n  isAvail"]],"start1":11256,"start2":11256,"length1":28,"length2":24}]],"length":11360,"saved":false},"1337426919771":{"contributors":[],"silentsave":false,"ts":1337426919771,"patch":[[{"diffs":[[0,"ion(resJson) {\r\n"],[-1,"    \r\n"],[0,"    if (!isAuthe"]],"start1":9226,"start2":9226,"length1":38,"length2":32},{"diffs":[[0,"icated(req)) {\r\n"],[1,""],[0,"      res.redire"]],"start1":9260,"start2":9260,"length1":32,"length2":32},{"diffs":[[0,"r, document) {\r\n"],[-1,"  \r\n"],[0,"      if (!isVal"]],"start1":9425,"start2":9425,"length1":36,"length2":32},{"diffs":[[0," = [];\r\n"],[-1,"      \r\n"],[0,"      fo"]],"start1":9670,"start2":9670,"length1":24,"length2":16},{"diffs":[[0,"}\r\n      }\r\n"],[-1,"      \r\n"],[0,"      update"]],"start1":9955,"start2":9955,"length1":32,"length2":24},{"diffs":[[0,"omments };\r\n"],[-1,"      \r\n"],[0,"      condit"]],"start1":9999,"start2":9999,"length1":32,"length2":24},{"diffs":[[0,"ment};\r\n"],[-1,"      \r\n"],[0,"      do"]],"start1":10044,"start2":10044,"length1":24,"length2":16},{"diffs":[[0,"ion(resJson) {\r\n"],[-1,"    \r\n"],[0,"    documentMode"]],"start1":10494,"start2":10494,"length1":38,"length2":32},{"diffs":[[0,"     }\r\n  \r\n"],[1,""],[0,"      var da"]],"start1":10687,"start2":10687,"length1":24,"length2":24},{"diffs":[[0,"ength;\r\n"],[-1,"      \r\n"],[0,"      da"]],"start1":10714,"start2":10714,"length1":24,"length2":16}]],"length":11304,"saved":false},"1337427293432":{"contributors":[],"silentsave":false,"ts":1337427293432,"patch":[[{"diffs":[[0," , boardName"],[1,"\r\n  , gridStore"],[0,";\r\n\r\nmodel  "]],"start1":60,"start2":60,"length1":24,"length2":39}]],"length":11319,"saved":false},"1337427303305":{"contributors":[],"silentsave":false,"ts":1337427303305,"patch":[[{"diffs":[[0,"Board;\r\n"],[1,"gridStore       = model.\r\n"],[0,"fs      "]],"start1":205,"start2":205,"length1":16,"length2":42}]],"length":11345,"saved":false},"1337427307158":{"contributors":[],"silentsave":false,"ts":1337427307158,"patch":[[{"diffs":[[0,"= model."],[1,"saveGridStore"],[0,"\r\nfs    "]],"start1":229,"start2":229,"length1":16,"length2":29}]],"length":11358,"saved":false},"1337427308045":{"contributors":[],"silentsave":false,"ts":1337427308045,"patch":[[{"diffs":[[0,"ridStore"],[1,";"],[0,"\r\nfs    "]],"start1":242,"start2":242,"length1":16,"length2":17}]],"length":11359,"saved":false},"1337427325836":{"contributors":[],"silentsave":false,"ts":1337427325836,"patch":[[{"diffs":[[0," Buffer(file);\r\n"],[1,"          gridStore(dataFile.name, buffer);\r\n"],[0,"          docume"]],"start1":4501,"start2":4501,"length1":32,"length2":77}]],"length":11404,"saved":false},"1337427773562":{"contributors":[],"silentsave":false,"ts":1337427773562,"patch":[[{"diffs":[[0,"        "],[1,"//"],[0,"gridStor"]],"start1":4519,"start2":4519,"length1":16,"length2":18}]],"length":11406,"saved":false},"1337513588234":{"contributors":[],"silentsave":false,"ts":1337513588234,"patch":[[{"diffs":[[0,"els');\r\n"],[1,"formidable      = require('formidable');\r\nutil            = require('util');\r\n"],[0,"document"]],"start1":124,"start2":124,"length1":16,"length2":94},{"diffs":[[0," maxIndex;\r\n"],[-1,""],[0,""],[1,"    "],[0,"\r\n  if (req."]],"start1":1804,"start2":1804,"length1":24,"length2":28},{"diffs":[[0,"ind("],[-1,"{'id' : {'$gte': lower, '$lte': upper}}"],[1,")\r\n      .skip(15 * index - 15)\r\n      .limit(15"],[0,")\r\n "]],"start1":2313,"start2":2313,"length1":47,"length2":56},{"diffs":[[0,"on(req, res) {\r\n"],[1,"  var document\r\n    , documentData\r\n    , dataFile\r\n    , file\r\n    , buffer\r\n    , index;\r\n  \r\n"],[0,"  boardName = re"]],"start1":3519,"start2":3519,"length1":32,"length2":128},{"diffs":[[0,".params.board;\r\n"],[-1,"  \r\n"],[0,"  isAvailableBoa"]],"start1":3648,"start2":3648,"length1":36,"length2":32},{"diffs":[[0,") {\r"],[-1,"\n      var document\r\n        , dataFile\r\n        , file\r\n        , buffer\r\n        , name\r\n        , index;\r"],[0,"\n\r\n "]],"start1":3841,"start2":3841,"length1":116,"length2":8},{"diffs":[[0,"eq.body.title =="],[-1,""],[0,""],[1,"="],[0," '') {\r\n        "]],"start1":3995,"start2":3995,"length1":32,"length2":33},{"diffs":[[0,"];\r\n"],[-1,"\r\n      var i = 0;"],[1,"      documentData.files    = [];\r\n      \r\n      for (var key in req.files) {"],[0,"\r\n      "],[-1,"while ("],[1,"  "],[0,"data"]],"start1":4394,"start2":4394,"length1":41,"length2":95},{"diffs":[[0,"q.files["],[-1,"'dataFile' + i]) {"],[1,"key];"],[0,"\r\n      "]],"start1":4498,"start2":4498,"length1":34,"length2":21},{"diffs":[[0,"buffer);"],[1,"z"],[0,"\r\n      "]],"start1":4671,"start2":4671,"length1":16,"length2":17},{"diffs":[[0,"ta.files"],[-1,"[i] = "],[1,".push("],[0,"{name: d"]],"start1":4702,"start2":4702,"length1":22,"length2":22},{"diffs":[[0,"tring('base64')}"],[1,")"],[0,";\r\n        }\r\n  "]],"start1":4754,"start2":4754,"length1":32,"length2":33},{"diffs":[[0,"       }\r\n      "],[-1,"  i ++"],[1,"}\r\n      \r\n      console.log(documentData)"],[0,";\r\n      }\r\n\r\n  "]],"start1":4775,"start2":4775,"length1":38,"length2":74},{"diffs":[[0,"ntData);\r\n      "],[-1,"}"],[0,"\r\n"],[1,"      "],[0,"\r\n      document"]],"start1":4826,"start2":4826,"length1":35,"length2":40},{"diffs":[[0,"ta.save("],[-1," "],[0,"function"],[1," "],[0,"(err) {\r"]],"start1":4868,"start2":4868,"length1":25,"length2":25}]],"length":11566,"saved":false},"1337513590178":{"contributors":[],"silentsave":false,"ts":1337513590178,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"      console.log(documentData);\r\n      \r\n      \r\n"],[0,"    "]],"start1":4798,"start2":4798,"length1":58,"length2":8}]],"length":11516,"saved":false},"1337513875650":{"contributors":[],"silentsave":false,"ts":1337513875650,"patch":[[{"diffs":[[0," }\r\n      \r\n"],[1,"      console.log(documentData);\r\n      \r\n"],[0,"      docume"]],"start1":4790,"start2":4790,"length1":24,"length2":66}]],"length":11558,"saved":false},"1337514238841":{"contributors":[],"silentsave":false,"ts":1337514238841,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"      console.log(documentData);\r\n      \r\n"],[0,"    "]],"start1":4798,"start2":4798,"length1":50,"length2":8}]],"length":11516,"saved":false},"1337514274263":{"contributors":[],"silentsave":false,"ts":1337514274263,"patch":[[{"diffs":[[0,"        res."],[-1,"redirect"],[1,"end"],[0,"('/board/' +"]],"start1":4844,"start2":4844,"length1":32,"length2":27}]],"length":11511,"saved":false},"1337515372622":{"contributors":[],"silentsave":false,"ts":1337515372622,"patch":[[{"diffs":[[0,"        res."],[-1,"redirect"],[1,"end"],[0,"('/board/' +"]],"start1":6257,"start2":6257,"length1":32,"length2":27}]],"length":11506,"saved":false},"1337515559777":{"contributors":[],"silentsave":false,"ts":1337515559777,"patch":[[{"diffs":[[0,"     }\r\n  \r\n"],[1,"      console.log(conditions);\r\n      \r\n"],[0,"      model."]],"start1":6188,"start2":6188,"length1":24,"length2":64}]],"length":11546,"saved":false},"1337516045534":{"contributors":[],"silentsave":false,"ts":1337516045534,"patch":[[{"diffs":[[0,"ole.log("],[-1,"condition"],[1,"update"],[0,"s);\r\n   "]],"start1":6210,"start2":6210,"length1":25,"length2":22}]],"length":11543,"saved":false},"1337516102185":{"contributors":[],"silentsave":false,"ts":1337516102185,"patch":[[{"diffs":[[0,"iles"],[-1,"[i + fileLength] = "],[1,".push("],[0,"{nam"]],"start1":6081,"start2":6081,"length1":27,"length2":14},{"diffs":[[0,"ase64')}"],[1,")"],[0,";\r\n     "]],"start1":6137,"start2":6137,"length1":16,"length2":17}]],"length":11531,"saved":false},"1337516120914":{"contributors":[],"silentsave":false,"ts":1337516120914,"patch":[[{"diffs":[[0,"    "],[-1,"while (dataFile = req.files['dataFile' + i]) {"],[1,"for (var key in req.files) {\r\n        dataFile = req.files[key];"],[0,"\r\n  "]],"start1":5889,"start2":5889,"length1":54,"length2":72}]],"length":11549,"saved":false},"1337516900035":{"contributors":[],"silentsave":false,"ts":1337516900035,"patch":[[{"diffs":[[0,"dStore;\r"],[1,"\n  , io\r"],[0,"\n\r\nmodel"]],"start1":81,"start2":81,"length1":16,"length2":24}]],"length":11557,"saved":false},"1337516908494":{"contributors":[],"silentsave":false,"ts":1337516908494,"patch":[[{"diffs":[[0,"\r\n  , io"],[1,";"],[0,"\r\n\r\nmode"]],"start1":88,"start2":88,"length1":16,"length2":17},{"diffs":[[0,"ire('fs');\r\n"],[1,"io              = require('socket.io');\r\n"],[0,"\r\n\r\n// 로그인 확"]],"start1":362,"start2":362,"length1":24,"length2":65}]],"length":11599,"saved":false},"1337519079547":{"contributors":[],"silentsave":false,"ts":1337519079547,"patch":[[{"diffs":[[0,"ridStore"],[-1,";"],[0,"\r\n  , io"]],"start1":79,"start2":79,"length1":17,"length2":16}]],"length":11598,"saved":false},"1337525591434":{"contributors":[],"silentsave":false,"ts":1337525591434,"patch":[[{"diffs":[[0,");\r\n"],[-1,"io              = require('socket.io');\r\n"],[0,"\r\n\r\n"]],"start1":369,"start2":369,"length1":49,"length2":8}]],"length":11557,"saved":false},"1337525677171":{"contributors":[],"silentsave":false,"ts":1337525677171,"patch":[[{"diffs":[[0,"tore"],[-1,"\r\n  , io"],[0,";\r\n\r"]],"start1":83,"start2":83,"length1":16,"length2":8}]],"length":11549,"saved":false},"1337529256037":{"contributors":[],"silentsave":false,"ts":1337529256037,"patch":[[{"diffs":[[0,"ridStore"],[1,"\r\n  , socket"],[0,";\r\n\r\nmod"]],"start1":79,"start2":79,"length1":16,"length2":28}]],"length":11561,"saved":false},"1337529269237":{"contributors":[],"silentsave":false,"ts":1337529269237,"patch":[[{"diffs":[[0,"til');\r\n"],[1,"socket          = require('./socket');\r\n"],[0,"document"]],"start1":214,"start2":214,"length1":16,"length2":56}]],"length":11601,"saved":false},"1337529286406":{"contributors":[],"silentsave":false,"ts":1337529286406,"patch":[[{"diffs":[[0,"tore"],[1,";"],[0,"\r\n  "],[-1,", socket;\r\n"],[0,"\r\nmo"]],"start1":83,"start2":83,"length1":23,"length2":13},{"diffs":[[0,");\r\n"],[-1,"socket          = require('./socket');\r\n"],[0,"docu"]],"start1":208,"start2":208,"length1":48,"length2":8}]],"length":11551,"saved":false},"1337549436083":{"contributors":[],"silentsave":false,"ts":1337549436083,"patch":[[{"diffs":[[0,"  = req."],[-1,"params"],[1,"body"],[0,".idComme"]],"start1":9363,"start2":9363,"length1":22,"length2":20}]],"length":11549,"saved":false},"1337549444909":{"contributors":[],"silentsave":false,"ts":1337549444909,"patch":[[{"diffs":[[0,"req.body"],[-1,"."],[1,"['"],[0,"idCommen"]],"start1":9367,"start2":9367,"length1":17,"length2":18},{"diffs":[[0,"dComment"],[1,"']"],[0,";\r\n  boa"]],"start1":9378,"start2":9378,"length1":16,"length2":18}]],"length":11552,"saved":false},"1337549537452":{"contributors":[],"silentsave":false,"ts":1337549537452,"patch":[[{"diffs":[[0,"\r\n      res."],[-1,"redirect"],[1,"end"],[0,"('/board/' +"]],"start1":9522,"start2":9522,"length1":32,"length2":27}]],"length":11547,"saved":false},"1337549549562":{"contributors":[],"silentsave":false,"ts":1337549549562,"patch":[[{"diffs":[[0,"end("],[-1,"'/board/' + boardName + '/read/' + id"],[0,");\r\n"]],"start1":9534,"start2":9534,"length1":45,"length2":8},{"diffs":[[0,"res."],[-1,"redirect('/board/' + boardName + '/read/' + id"],[1,"end("],[0,");\r\n"]],"start1":9701,"start2":9701,"length1":54,"length2":12}]],"length":11468,"saved":false},"1337549578864":{"contributors":[],"silentsave":false,"ts":1337549578864,"patch":[[{"diffs":[[0,"res."],[-1,"redirect('/board/' + boardName + '/read/' + idDocument"],[1,"end('success'"],[0,");\r\n"]],"start1":10300,"start2":10300,"length1":62,"length2":21}]],"length":11427,"saved":false},"1337550165966":{"contributors":[],"silentsave":false,"ts":1337550165966,"patch":[[{"diffs":[[0,"res."],[-1,"redirect('/board/' + boardName + '/read/' + id"],[1,"end("],[0,");\r\n"]],"start1":8373,"start2":8373,"length1":54,"length2":12}]],"length":11385,"saved":false},"1337550170273":{"contributors":[],"silentsave":false,"ts":1337550170273,"patch":[[{"diffs":[[0,"res."],[-1,"redirect('/board/' + boardName + '/read/' + id"],[1,"end("],[0,");\r\n"]],"start1":8542,"start2":8542,"length1":54,"length2":12}]],"length":11343,"saved":false},"1337550174910":{"contributors":[],"silentsave":false,"ts":1337550174910,"patch":[[{"diffs":[[0,"        res.end("],[1,"''"],[0,");\r\n        retu"]],"start1":8534,"start2":8534,"length1":32,"length2":34}]],"length":11345,"saved":false},"1337550177155":{"contributors":[],"silentsave":false,"ts":1337550177155,"patch":[[{"diffs":[[0,"es.end('"],[1,"fail"],[0,"');\r\n   "]],"start1":8543,"start2":8543,"length1":16,"length2":20}]],"length":11349,"saved":false},"1337550184363":{"contributors":[],"silentsave":false,"ts":1337550184363,"patch":[[{"diffs":[[0,"\r\n      res.end("],[1,"'fail'"],[0,");\r\n      return"]],"start1":8365,"start2":8365,"length1":32,"length2":38}]],"length":11355,"saved":false},"1337550205124":{"contributors":[],"silentsave":false,"ts":1337550205124,"patch":[[{"diffs":[[0,"\n      res.end('"],[-1,"fail"],[1,"notAuthenticated"],[0,"');\r\n      retur"]],"start1":8366,"start2":8366,"length1":36,"length2":48}]],"length":11367,"saved":false},"1337550213225":{"contributors":[],"silentsave":false,"ts":1337550213225,"patch":[[{"diffs":[[0,"nd('"],[-1,"fail"],[1,"inValidDocument"],[0,"');\r"]],"start1":8565,"start2":8565,"length1":12,"length2":23}]],"length":11378,"saved":false},"1337550257407":{"contributors":[],"silentsave":false,"ts":1337550257407,"patch":[[{"diffs":[[0,"\r\n      res.end("],[1,"'notAuthenticated'"],[0,");\r\n      return"]],"start1":9473,"start2":9473,"length1":32,"length2":50},{"diffs":[[0,"        res.end("],[1,"'inValidDocument'"],[0,");\r\n        retu"]],"start1":9662,"start2":9662,"length1":32,"length2":49}]],"length":11413,"saved":false},"1337551607976":{"contributors":[],"silentsave":false,"ts":1337551607976,"patch":[[{"diffs":[[0,"        res."],[-1,"redirect"],[1,"end"],[0,"('/board/' +"]],"start1":8957,"start2":8957,"length1":32,"length2":27}]],"length":11408,"saved":false},"1337551615794":{"contributors":[],"silentsave":false,"ts":1337551615794,"patch":[[{"diffs":[[0,"nd('"],[-1,"/board/' + boardName + '/read/' + id"],[1,"'"],[0,");\r\n"]],"start1":8970,"start2":8970,"length1":44,"length2":9}]],"length":11373,"saved":false},"1337613056593":{"contributors":[],"silentsave":false,"ts":1337613056593,"patch":[[{"diffs":[[0,"\n  });\r\n"],[-1,"\r\n"],[0,"};\r\n\r\n//"]],"start1":9015,"start2":9015,"length1":18,"length2":16}]],"length":11371,"saved":false},"1337613479058":{"contributors":[],"silentsave":false,"ts":1337613479058,"patch":[[{"diffs":[[0,"id': id}\r\n  "],[1,"    date = Date.now();\r\n      "],[0,"\r\n      upda"]],"start1":8641,"start2":8641,"length1":24,"length2":54},{"diffs":[[0,"ate   : "],[-1,"Date.now()"],[0,"\r\n      "]],"start1":8876,"start2":8876,"length1":26,"length2":16}]],"length":11391,"saved":false},"1337613481377":{"contributors":[],"silentsave":false,"ts":1337613481377,"patch":[[{"diffs":[[0,"ate   : "],[1,"datae"],[0,"\r\n      "]],"start1":8876,"start2":8876,"length1":16,"length2":21}]],"length":11396,"saved":false},"1337613483236":{"contributors":[],"silentsave":false,"ts":1337613483236,"patch":[[{"diffs":[[0,"   : dat"],[-1,"a"],[0,"e\r\n     "]],"start1":8879,"start2":8879,"length1":17,"length2":16}]],"length":11395,"saved":false},"1337613494090":{"contributors":[],"silentsave":false,"ts":1337613494090,"patch":[[{"diffs":[[0," {\r\n"],[-1,"        res.end('');\r\n"],[0,"    "]],"start1":8977,"start2":8977,"length1":30,"length2":8}]],"length":11373,"saved":false},"1337613523584":{"contributors":[],"silentsave":false,"ts":1337613523584,"patch":[[{"diffs":[[0,"unction(err) {\r\n"],[1,"        console.log(document);\r\n"],[0,"        return;\r"]],"start1":8965,"start2":8965,"length1":32,"length2":64}]],"length":11405,"saved":false},"1337613932056":{"contributors":[],"silentsave":false,"ts":1337613932056,"patch":[[{"diffs":[[0,");\r\n      \r\n"],[1,"      console.log('something');\r\n      \r\n"],[0,"      update"]],"start1":8673,"start2":8673,"length1":24,"length2":65}]],"length":11446,"saved":false},"1337614095718":{"contributors":[],"silentsave":false,"ts":1337614095718,"patch":[[{"diffs":[[0,"    "],[-1,"console.log(docu"],[1,"document.comments.find({'date': date}, function(err, com"],[0,"ment)"],[-1,";"],[1," {"],[0,"\r\n  "]],"start1":9026,"start2":9026,"length1":30,"length2":71},{"diffs":[[0,"ent) {\r\n        "],[-1,"return"],[1,"  \r\n        })"],[0,";\r\n      });\r\n  "]],"start1":9087,"start2":9087,"length1":38,"length2":46}]],"length":11495,"saved":false},"1337614100064":{"contributors":[],"silentsave":false,"ts":1337614100064,"patch":[[{"diffs":[[0,"nts.find"],[1,"One"],[0,"({'date'"]],"start1":9044,"start2":9044,"length1":16,"length2":19}]],"length":11498,"saved":false},"1337614109527":{"contributors":[],"silentsave":false,"ts":1337614109527,"patch":[[{"diffs":[[0,"\r\n          "],[1,"res.end(comment);"],[0,"\r\n        })"]],"start1":9096,"start2":9096,"length1":24,"length2":41}]],"length":11515,"saved":false},"1337614113753":{"contributors":[],"silentsave":false,"ts":1337614113753,"patch":[[{"diffs":[[0,"(comment);\r\n"],[1,"          return;\r\n"],[0,"        });\r"]],"start1":9115,"start2":9115,"length1":24,"length2":43}]],"length":11534,"saved":false},"1337614192175":{"contributors":[],"silentsave":false,"ts":1337614192175,"patch":[[{"diffs":[[0,"    "],[-1,"document.comments.findOne({'date': date}, function(err,"],[1,"for (comment in"],[0," comm"],[-1,"ent"],[1,"nets"],[0,") {\r"]],"start1":9026,"start2":9026,"length1":71,"length2":32},{"diffs":[[0,"    "],[-1,"res.end"],[1,"if "],[0,"(comment"],[-1,");"],[1,"['date'] === date) {"],[0,"\r\n  "]],"start1":9065,"start2":9065,"length1":25,"length2":39},{"diffs":[[0,"e) {\r\n          "],[-1,"return;"],[1,"  "],[0,"\r\n        });\r\n "]],"start1":9096,"start2":9096,"length1":39,"length2":34},{"diffs":[[0,"  \r\n        "],[1," "],[1," "],[0,"});\r\n"],[1,"        }\r\n"],[0,"      });\r\n "]],"start1":9112,"start2":9112,"length1":29,"length2":42}]],"length":11517,"saved":false},"1337614206535":{"contributors":[],"silentsave":false,"ts":1337614206535,"patch":[[{"diffs":[[0,"            "],[1,"res.end(comment);\r\n            return;"],[0,"\r\n          "]],"start1":9102,"start2":9102,"length1":24,"length2":62}]],"length":11555,"saved":false},"1337614213808":{"contributors":[],"silentsave":false,"ts":1337614213808,"patch":[[{"diffs":[[0,"    res."],[-1,"end"],[1,"json"],[0,"(comment"]],"start1":9110,"start2":9110,"length1":19,"length2":20}]],"length":11556,"saved":false},"1337614218225":{"contributors":[],"silentsave":false,"ts":1337614218225,"patch":[[{"diffs":[[0,"   for ("],[1,"var "],[0,"comment "]],"start1":9027,"start2":9027,"length1":16,"length2":20}]],"length":11560,"saved":false},"1337614225461":{"contributors":[],"silentsave":false,"ts":1337614225461,"patch":[[{"diffs":[[0,"  });\r\n        }"],[1,";"],[0,"\r\n      });\r\n   "]],"start1":9167,"start2":9167,"length1":32,"length2":33}]],"length":11561,"saved":false},"1337614233514":{"contributors":[],"silentsave":false,"ts":1337614233514,"patch":[[{"diffs":[[0," in "],[1,"document."],[0,"comm"],[-1,"n"],[0,"e"],[1,"n"],[0,"ts) "]],"start1":9046,"start2":9046,"length1":14,"length2":23},{"diffs":[[0,"       }"],[-1,";"],[0,"\r\n      "]],"start1":9184,"start2":9184,"length1":17,"length2":16}]],"length":11569,"saved":false},"1337614246639":{"contributors":[],"silentsave":false,"ts":1337614246639,"patch":[[{"diffs":[[0,"rn;\r\n          }"],[-1,");"],[0,"\r\n        }\r\n   "]],"start1":9163,"start2":9163,"length1":34,"length2":32}]],"length":11567,"saved":false},"1337614273617":{"contributors":[],"silentsave":false,"ts":1337614273617,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"      console.log('something');\r\n      \r\n"],[0,"    "]],"start1":8681,"start2":8681,"length1":49,"length2":8}]],"length":11526,"saved":false},"1337614323286":{"contributors":[],"silentsave":false,"ts":1337614323286,"patch":[[{"diffs":[[0,"        "],[-1," "],[1,","],[0," name   "]],"start1":8782,"start2":8782,"length1":17,"length2":17}]],"length":11526,"saved":false},"1337614360546":{"contributors":[],"silentsave":false,"ts":1337614360546,"patch":[[{"diffs":[[0,"push({\r\n"],[1,"          tempID :\r\n"],[0,"        "]],"start1":8774,"start2":8774,"length1":16,"length2":36}]],"length":11546,"saved":false},"1337614369625":{"contributors":[],"silentsave":false,"ts":1337614369625,"patch":[[{"diffs":[[0,"tempID :"],[1," "],[0,"\r\n      "]],"start1":8792,"start2":8792,"length1":16,"length2":17}]],"length":11547,"saved":false},"1337614381689":{"contributors":[],"silentsave":false,"ts":1337614381689,"patch":[[{"diffs":[[0,"empID : "],[1,"date.toString()"],[0,"\r\n      "]],"start1":8793,"start2":8793,"length1":16,"length2":31}]],"length":11562,"saved":false},"1337614397177":{"contributors":[],"silentsave":false,"ts":1337614397177,"patch":[[{"diffs":[[0,"nt.comments) {\r\n"],[1,"          var dateString = date.toString();\r\n"],[0,"          if (co"]],"start1":9051,"start2":9051,"length1":32,"length2":77},{"diffs":[[0,"=== date"],[1,"String"],[0,") {\r\n   "]],"start1":9142,"start2":9142,"length1":16,"length2":22}]],"length":11613,"saved":false},"1337614407342":{"contributors":[],"silentsave":false,"ts":1337614407342,"patch":[[{"diffs":[[0,"omment['"],[-1,"da"],[0,"te"],[1,"mpID"],[0,"'] === d"]],"start1":9127,"start2":9127,"length1":20,"length2":22}]],"length":11615,"saved":false},"1337614537557":{"contributors":[],"silentsave":false,"ts":1337614537557,"patch":[[{"diffs":[[0,"unction(err) {\r\n"],[1,"        console.log(document.comments);\r\n"],[0,"        for (var"]],"start1":9001,"start2":9001,"length1":32,"length2":73}]],"length":11656,"saved":false},"1337614545844":{"contributors":[],"silentsave":false,"ts":1337614545844,"patch":[[{"diffs":[[0,"comments);\r\n"],[1,"        console.log(date.toString();\r\n"],[0,"        for "]],"start1":9046,"start2":9046,"length1":24,"length2":62}]],"length":11694,"saved":false},"1337614567117":{"contributors":[],"silentsave":false,"ts":1337614567117,"patch":[[{"diffs":[[0,"(date.toString()"],[1,")"],[0,";\r\n        for ("]],"start1":9077,"start2":9077,"length1":32,"length2":33}]],"length":11695,"saved":false},"1337614639029":{"contributors":[],"silentsave":false,"ts":1337614639029,"patch":[[{"diffs":[[0," {\r\n"],[-1,"        console.log(document.comments);\r\n        console.log(date.toString());\r\n"],[0,"    "]],"start1":9013,"start2":9013,"length1":88,"length2":8},{"diffs":[[0,"oString();\r\n"],[1,"          console.log(comment['tempID'] + ' === ' + dateString);\r\n"],[0,"          if"]],"start1":9100,"start2":9100,"length1":24,"length2":90}]],"length":11681,"saved":false},"1337614657672":{"contributors":[],"silentsave":false,"ts":1337614657672,"patch":[[{"diffs":[[0,"teString);\r\n"],[1,"          console.log(cooment['tempID'] == dateString);\r\n"],[0,"          if"]],"start1":9166,"start2":9166,"length1":24,"length2":81}]],"length":11738,"saved":false},"1337614679755":{"contributors":[],"silentsave":false,"ts":1337614679755,"patch":[[{"diffs":[[0,"e.log(co"],[-1,"o"],[1,","],[0,"ment['te"]],"start1":9194,"start2":9194,"length1":17,"length2":17}]],"length":11738,"saved":false},"1337614680859":{"contributors":[],"silentsave":false,"ts":1337614680859,"patch":[[{"diffs":[[0,"e.log(co"],[-1,","],[1,"m"],[0,"ment['te"]],"start1":9194,"start2":9194,"length1":17,"length2":17}]],"length":11738,"saved":false},"1337614754514":{"contributors":[],"silentsave":false,"ts":1337614754514,"patch":[[{"diffs":[[0,"unction(err) {\r\n"],[1,"        console.log(document.comments);\r\n"],[0,"        for (var"]],"start1":9001,"start2":9001,"length1":32,"length2":73}]],"length":11779,"saved":false},"1337614773902":{"contributors":[],"silentsave":false,"ts":1337614773902,"patch":[[{"diffs":[[0,"unction(err) {\r\n"],[1,"        var dateString = date.toString()\r\n          , comment;\r\n"],[0,"        console."]],"start1":9001,"start2":9001,"length1":32,"length2":96},{"diffs":[[0,"or (var "],[-1,"comment"],[1,"key"],[0," in docu"]],"start1":9131,"start2":9131,"length1":23,"length2":19},{"diffs":[[0," {\r\n"],[-1,"          var dateString = date.toString();\r\n"],[0,"    "]],"start1":9164,"start2":9164,"length1":53,"length2":8}]],"length":11794,"saved":false},"1337614788637":{"contributors":[],"silentsave":false,"ts":1337614788637,"patch":[[{"diffs":[[0,"nt.comments) {\r\n"],[1,"          comment = document.comments[key];\r\n"],[0,"          consol"]],"start1":9152,"start2":9152,"length1":32,"length2":77}]],"length":11839,"saved":false},"1337614822436":{"contributors":[],"silentsave":false,"ts":1337614822436,"patch":[[{"diffs":[[0,"t;\r\n"],[-1,"        console.log(document.comments);\r\n"],[0,"    "]],"start1":9077,"start2":9077,"length1":49,"length2":8},{"diffs":[[0,"];\r\n"],[-1,"          console.log(comment['tempID'] + ' === ' + dateString);\r\n          console.log(comment['tempID'] == dateString);\r\n"],[0,"    "]],"start1":9168,"start2":9168,"length1":131,"length2":8}]],"length":11675,"saved":false},"1337617318684":{"contributors":[],"silentsave":false,"ts":1337617318684,"patch":[[{"diffs":[[0,"buffer);"],[-1,"z"],[0,"\r\n      "]],"start1":4673,"start2":4673,"length1":17,"length2":16}]],"length":11674,"saved":false},"1337667498760":{"contributors":[],"silentsave":false,"ts":1337667498760,"patch":[[{"diffs":[[0,"ridStore"],[-1,""],[0,""],[1,"\r\n  , deleteGridStore\r\n  , readGridStore"],[0,";\r\n  \r\nm"]],"start1":79,"start2":79,"length1":16,"length2":56},{"diffs":[[0,");\r\n"],[-1,"formidable      = require('formidable');\r\n"],[0,"util"]],"start1":170,"start2":170,"length1":50,"length2":8},{"diffs":[[0,"Store;\r\n"],[1,"deleteGridStore = model.deleteGridStore;\r\nreadGridStore   = model.readGridStore;\r\n"],[0,"fs      "]],"start1":323,"start2":323,"length1":16,"length2":98},{"diffs":[[0,"\n    , index"],[-1,""],[0,""],[1,"\r\n    , date"],[0,";\r\n  \r\n  boa"]],"start1":3694,"start2":3694,"length1":24,"length2":36},{"diffs":[[0,";\r\n      }\r\n"],[1,"      \r\n      var date = Date.now()\r\n"],[0,"      docume"]],"start1":4145,"start2":4145,"length1":24,"length2":61},{"diffs":[[0,".date     = "],[-1,"D"],[1,"d"],[0,"ate"],[-1,".now()"],[0,";\r\n      doc"]],"start1":4469,"start2":4469,"length1":34,"length2":28},{"diffs":[[0,"    "],[-1,"buffer = new Buffer(file);\r\n          //gridStore("],[1,"gridStore(documentData._id + dataFile.name , file);\r\n          documentData.files.push(documentData._id + "],[0,"data"]],"start1":4727,"start2":4727,"length1":58,"length2":114},{"diffs":[[0,"ile.name"],[-1,", buffer"],[0,");\r\n    "]],"start1":4842,"start2":4842,"length1":24,"length2":16},{"diffs":[[0,"me);\r\n          "],[1,"//"],[0,"documentData.fil"]],"start1":4848,"start2":4848,"length1":32,"length2":34},{"diffs":[[0,"    });\r\n  });\r\n"],[-1,"  \r\n"],[0,"};\r\n\r\n// Update "]],"start1":5087,"start2":5087,"length1":36,"length2":32},{"diffs":[[0,"leLength"],[-1,""],[0,""],[1,"\r\n    , date"],[0,";\r\n\r\n  b"]],"start1":5279,"start2":5279,"length1":16,"length2":28},{"diffs":[[0,": id};\r\n"],[1,"      \r\n      date = Date.now();\r\n"],[0,"  \r\n    "]],"start1":5761,"start2":5761,"length1":16,"length2":50},{"diffs":[[0,"te    = "],[-1,"D"],[1,"d"],[0,"ate"],[-1,".now()"],[0,";\r\n  \r\n "]],"start1":5928,"start2":5928,"length1":26,"length2":20},{"diffs":[[0,"    "],[-1,"buffer = new Buffer(file);\r\n          updates.files.push({name: dataFile.name, data: buffer.toString('base64')}"],[1,"gridStore(document._id + dataFile.name, file);\r\n          updates.files.push(document._id + dataFile.name"],[0,");\r\n"]],"start1":6258,"start2":6258,"length1":119,"length2":113},{"diffs":[[0,"  \r\n"],[-1,"      console.log(updates);\r\n      \r\n"],[0,"    "]],"start1":6406,"start2":6406,"length1":45,"length2":8},{"diffs":[[0,"  var id"],[-1,""],[0,""],[1,"\r\n    , length"],[0,";\r\n\r\n  b"]],"start1":6626,"start2":6626,"length1":16,"length2":30},{"diffs":[[0,"turn;\r\n      }\r\n"],[1,"      \r\n      var length = document.files.length;\r\n      for (var i = 0; i < length; i++)  {\r\n        deleteGridStore(document.files[i]);\r\n      }\r\n"],[0,"  \r\n      docume"]],"start1":6961,"start2":6961,"length1":32,"length2":180},{"diffs":[[0,"    , name\r\n"],[1,"    , fileName\r\n"],[0,"    , buffer"]],"start1":11023,"start2":11023,"length1":24,"length2":40},{"diffs":[[0,"rdName;\r"],[1,"\n  fileName  = name;\r"],[0,"\n\r\n  isA"]],"start1":11152,"start2":11152,"length1":16,"length2":37},{"diffs":[[0,"th;\r\n      for ("],[1,"var "],[0,"i = 0; i < dataL"]],"start1":11495,"start2":11495,"length1":32,"length2":36},{"diffs":[[0,"files[i]"],[-1,".name"],[0," == name"]],"start1":11567,"start2":11567,"length1":21,"length2":16},{"diffs":[[0,"        "],[1,"//"],[0,"buffer ="]],"start1":11594,"start2":11594,"length1":16,"length2":18},{"diffs":[[0,"ase64');\r\n  "],[1,"        readGridStore(name, function (result, buffer) {"],[0,"\r\n          "]],"start1":11650,"start2":11650,"length1":24,"length2":79},{"diffs":[[0,"r) {\r\n          "],[1," "],[1," "],[0,"res.writeHead(20"]],"start1":11713,"start2":11713,"length1":32,"length2":34},{"diffs":[[0,"' + name"],[1,".replace(document._id, '')"],[0,"});\r\n"],[1,"  "],[0,"        "]],"start1":11795,"start2":11795,"length1":21,"length2":49},{"diffs":[[0,"y');\r\n          "],[1,"  "],[0,"res.end();\r\n    "]],"start1":11870,"start2":11870,"length1":32,"length2":34},{"diffs":[[0,"res.end();\r\n"],[1,"  "],[0,"          re"]],"start1":11888,"start2":11888,"length1":24,"length2":26},{"diffs":[[0,"       return;\r\n"],[1,"          });\r\n          break;\r\n"],[0,"        }\r\n     "]],"start1":11905,"start2":11905,"length1":32,"length2":65}]],"length":12162,"saved":false},"1337720274738":{"contributors":[],"silentsave":false,"ts":1337720274738,"patch":[[{"diffs":[[0,"dataFile.path)\r\n"],[1,"          console.log(file);\r\n"],[0,"          gridSt"]],"start1":4705,"start2":4705,"length1":32,"length2":62}]],"length":12192,"saved":false},"1337720324176":{"contributors":[],"silentsave":false,"ts":1337720324176,"patch":[[{"diffs":[[0,"h)\r\n"],[-1,"          console.log(file);\r\n"],[0,"    "]],"start1":4717,"start2":4717,"length1":38,"length2":8}]],"length":12162,"saved":false}}}